
<!DOCTYPE html>
<!--[if IEMobile 7 ]><html class="no-js iem7"><![endif]-->
<!--[if lt IE 9]><html class="no-js lte-ie8"><![endif]-->
<!--[if (gt IE 8)|(gt IEMobile 7)|!(IEMobile)|!(IE)]><!--><html class="no-js" lang="en"><!--<![endif]-->
<head>
  <meta charset="utf-8">
  <title>使用CameraX 1.5进行高速拍摄和慢动作视频拍摄 - 稀有猿诉</title>
  <meta name="author" content="Alex Hilton">

  
  <meta name="description" content="本文详细地介绍如何用最新的Jetpack CameraX 1.5来进行高速视频拍摄和慢动作视频拍摄。">
  <meta name="keywords" content="CameraX, Android, High speed, Slow motion">

  <!-- http://t.co/dKP3o1e -->
  <meta name="HandheldFriendly" content="True">
  <meta name="MobileOptimized" content="320">
  <meta name="viewport" content="width=device-width, initial-scale=1">

  
  <link rel="canonical" href="https://alexhilton.github.io/blog/2025/11/05/camerax-slow-motion">
  <link href="/favicon.png" rel="icon">
  <link href="/stylesheets/screen.css" media="screen, projection" rel="stylesheet" type="text/css">
  <link href="/atom.xml" rel="alternate" title="稀有猿诉" type="application/atom+xml">
  <script src="/javascripts/modernizr-2.0.js"></script>
  <script src="https://code.jquery.com/jquery-3.6.4.min.js" integrity="sha256-oP6HI9z1XaZNBrJURtCoUT5SUnxFr8s3BzRl+cbzUq8=" crossorigin="anonymous"></script>
  <script>!window.jQuery && document.write(unescape('%3Cscript src="./javascripts/libs/jquery.min.js"%3E%3C/script%3E'))</script>
  <script src="/javascripts/octopress.js" type="text/javascript"></script>
  <script src="/javascripts/toolbar.js" type="text/javascript"></script>
  <!--Fonts from Google"s Web font directory at http://google.com/webfonts -->
<link href="//fonts.lug.ustc.edu.cn/css?family=PT+Serif:regular,italic,bold,bolditalic" rel="stylesheet" type="text/css">
<link href="//fonts.lug.ustc.edu.cn/css?family=PT+Sans:regular,italic,bold,bolditalic" rel="stylesheet" type="text/css">

<!-- for Gitment -->
<link rel="stylesheet" href="https://imsun.github.io/gitment/style/default.css">

<!-- for favicon -->
<link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png">
<link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png">
<link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png">
<link rel="manifest" href="/site.webmanifest">
<link rel="mask-icon" href="/safari-pinned-tab.svg" color="#5bbad5">
<meta name="msapplication-TileColor" content="#da532c">
<meta name="theme-color" content="#ffffff">

  

</head>

<body   >
  <header role="banner"><hgroup>
  <h1><a href="/">稀有猿诉</a></h1>
  
    <h2>十年磨一剑，历炼出锋芒，说话千百句，不如码二行。</h2>
  
</hgroup>

</header>
  <nav role="navigation"><ul class="subscription" data-subscription="rss">
  <li><a href="/atom.xml" rel="subscribe-rss" title="subscribe via RSS">RSS</a></li>
  
</ul>
  
<form action="https://www.google.com.hk/search" method="get">
  <fieldset role="search">
    <input type="hidden" name="q" value="site:alexhilton.github.io" />
    <input class="search" type="text" name="q" results="0" placeholder="Search"/>
  </fieldset>
</form>
  
<ul class="main-navigation">
  <li><a href="/">Home</a></li>
  <li><a href="/blog/archives">Archives</a></li>
  <li><a href="/donation">Donation</a></li>
  <li><a href="/about">About</a></li>
</ul>

</nav>
  <div id="main">
    <div id="content">
      <div>
<article class="hentry" role="article">
  
  <header>
    
      <h1 class="entry-title">使用CameraX 1.5进行高速拍摄和慢动作视频拍摄</h1>
    
    
      <p class="meta">
        




<time class='entry-date' datetime='2025-11-05T21:59:12+08:00'><span class='date'><span class='date-month'>Nov</span> <span class='date-day'>5</span><span class='date-suffix'>th</span>, <span class='date-year'>2025</span></span> <span class='time'>9:59 pm</span></time>
        
      </p>
    
  </header>


<div class="entry-content"><blockquote><p>本文译自「High-Speed Capture and Slow-Motion Video with CameraX 1.5」，原文链接<a href="https://android-developers.googleblog.com/2025/10/high-speed-capture-and-slow-motion.html">https://android-developers.googleblog.com/2025/10/high-speed-capture-and-slow-motion.html</a>，由Leo Huang发布于2025年10月28日。</p></blockquote>

<p><a href="/blog/2025/11/05/camerax-slow-motion/"><img src="https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEhSMEQNJHjQybdOLzAewkopnpZ6OUC0jYiXboj3chVWnaFbKtD5bPA4azyqjM7_ffdGv_nBnvYUgoqvhISE7-lff-aGkF8f200ENGHF9" title="auto auto" ></a></p>

<!-- more -->


<p>清晰捕捉快速运动的画面是现代相机应用的关键特性。这可以通过高速拍摄来实现——即以 120 或 240 fps 等速率采集帧。这种高保真拍摄可用于两种截然不同的用途：创建高帧率视频以进行逐帧的详细分析，或生成慢动作视频，使动作在屏幕上呈现出戏剧性的展开效果。</p>

<p>以前，使用 Camera2 API 实现这些功能需要更多的人工操作。现在，CameraX 1.5 中新增的<a href="https://developer.android.com/reference/androidx/camera/video/HighSpeedVideoSessionConfig">高速 API</a>简化了整个流程，让你可以灵活地创建真正的高帧率视频或即用型慢动作短片。本文将向你展示如何掌握这两种方法。如果你是 CameraX 新手，可以先阅读<a href="https://developer.android.com/media/camera/camerax">CameraX 概述</a>快速上手。</p>

<h2>慢动作原理</h2>

<p>慢动作的基本原理是以远高于播放帧率的帧率来录制视频。例如，如果你以每秒 120 帧 (fps) 的帧率录制一个一秒钟的事件，然后以标准的 30 fps 播放该录像，则视频需要四秒钟才能播放完毕。这种时间的“拉伸”正是慢动作效果的来源，让你能够看到肉眼无法捕捉到的快速细节。</p>

<p>为确保最终输出视频流畅自然，通常应以至少 30 fps 的帧率进行渲染。这意味着，要制作 4 倍慢动作视频，原始拍摄帧率必须至少为 120 fps（120 fps 拍摄帧率 ÷ 4 = 30 fps 播放帧率）。</p>

<p>拍摄高帧率素材后，主要有两种方法可以实现所需效果：</p>

<ul>
<li><p>播放器控制的慢动作（高帧率视频）：高速录制的视频（例如 120 fps）直接保存为高帧率视频文件。然后，视频播放器负责降低播放速度。这样，用户可以灵活地在正常播放和慢动作播放之间切换。</p></li>
<li><p>即用型慢动作（重新编码的视频）：高速视频流经过处理和重新编码，生成标准帧率（例如 30 fps）的文件。慢动作效果是通过调整帧时间戳“嵌入”到视频中的。生成的视频无需特殊处理即可在任何标准视频播放器中以慢动作播放。虽然视频默认以慢动作播放，但视频播放器仍然可以提供播放速度控制，允许用户加快播放速度并以原始速度观看视频。</p></li>
</ul>


<p>CameraX API 简化了这一过程，为你提供了一种统一的方式来选择所需的播放方式，如下所示。</p>

<h2>全新高速视频 API</h2>

<p>全新的 CameraX 解决方案基于两个主要组件：</p>

<ul>
<li><p><a href="https://developer.android.com/reference/kotlin/androidx/camera/video/Recorder#getHighSpeedVideoCapabilities(androidx.camera.core.CameraInfo)">Recorder#getHighSpeedVideoCapabilities(CameraInfo)</a>: 此方法用于检查摄像头是否支持高速录制，如果支持，则可查看支持哪些分辨率（Quality 对象）。</p></li>
<li><p><a href="https://developer.android.com/reference/androidx/camera/video/HighSpeedVideoSessionConfig">HighSpeedVideoSessionConfig</a>: 这是一个特殊的配置对象，用于将你的 VideoCapture 和 Preview 使用场景分组，并指示 CameraX 创建一个统一的高速摄像头会话。请注意，虽然 VideoCapture 流将以配置的高帧率运行，但为了确保屏幕流畅显示，预览流通常会被摄像头系统限制在至少 30 FPS 的标准帧率。</p></li>
</ul>


<h2>入门指南</h2>

<p>开始之前，请确保已将必要的 CameraX 依赖项添加到应用程序的 build.gradle.kts 文件中。你需要 camera-video 组件以及 CameraX 核心库。</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
</pre></td><td class='code'><pre><code class='kotlin'><span class='line'><span class="c1">// build.gradle.kts (Module: app)</span>
</span><span class='line'>
</span><span class='line'>
</span><span class='line'><span class="n">dependencies</span> <span class="p">{</span>
</span><span class='line'>
</span><span class='line'>    <span class="k">val</span> <span class="py">camerax_version</span> <span class="p">=</span> <span class="s">&quot;1.5.1&quot;</span>
</span><span class='line'>
</span><span class='line'>
</span><span class='line'>    <span class="n">implementation</span><span class="p">(</span><span class="s">&quot;androidx.camera:camera-core:$camerax_version&quot;</span><span class="p">)</span>
</span><span class='line'>
</span><span class='line'>    <span class="n">implementation</span><span class="p">(</span><span class="s">&quot;androidx.camera:camera-camera2:$camerax_version&quot;</span><span class="p">)</span>
</span><span class='line'>
</span><span class='line'>    <span class="n">implementation</span><span class="p">(</span><span class="s">&quot;androidx.camera:camera-lifecycle:$camerax_version&quot;</span><span class="p">)</span>
</span><span class='line'>
</span><span class='line'>    <span class="n">implementation</span><span class="p">(</span><span class="s">&quot;androidx.camera:camera-video:$camerax_version&quot;</span><span class="p">)</span>
</span><span class='line'>
</span><span class='line'>    <span class="n">implementation</span><span class="p">(</span><span class="s">&quot;androidx.camera:camera-view:$camerax_version&quot;</span><span class="p">)</span>
</span><span class='line'>
</span><span class='line'><span class="p">}</span>
</span></code></pre></td></tr></table></div></figure>


<h3>关于实验性 API 的说明</h3>

<p>需要注意的是，高速录制 API 目前处于实验阶段。这意味着它们在未来的版本中可能会发生变化。要使用它们，你必须通过在代码中添加以下注释来启用它们：</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class='kotlin'><span class='line'><span class="n">@kotlin</span><span class="p">.</span><span class="n">OptIn</span><span class="p">(</span><span class="n">ExperimentalSessionConfig</span><span class="o">::</span><span class="k">class</span><span class="p">,</span> <span class="n">ExperimentalHighSpeedVideo</span><span class="o">::</span><span class="k">class</span><span class="p">)</span>
</span></code></pre></td></tr></table></div></figure>


<h2>具体实现</h2>

<p>两种结果的实现都从相同的设置步骤开始。创建高帧率视频还是慢动作视频的选择取决于一个设置。</p>

<h3>1.设置高速拍摄</h3>

<p>首先，无论你的目标是什么，你都需要获取 <a href="https://developer.android.com/reference/androidx/camera/lifecycle/ProcessCameraProvider">ProcessCameraProvider</a>，检查设备功能，并创建你的使用场景。</p>

<p>以下代码块展示了在挂起函数中的完整设置流程。你可以从协程作用域调用此函数，例如 <code>lifecycleScope.launch</code>。</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
<span class='line-number'>25</span>
<span class='line-number'>26</span>
<span class='line-number'>27</span>
<span class='line-number'>28</span>
<span class='line-number'>29</span>
<span class='line-number'>30</span>
<span class='line-number'>31</span>
<span class='line-number'>32</span>
<span class='line-number'>33</span>
<span class='line-number'>34</span>
<span class='line-number'>35</span>
<span class='line-number'>36</span>
<span class='line-number'>37</span>
<span class='line-number'>38</span>
<span class='line-number'>39</span>
<span class='line-number'>40</span>
<span class='line-number'>41</span>
<span class='line-number'>42</span>
<span class='line-number'>43</span>
<span class='line-number'>44</span>
<span class='line-number'>45</span>
<span class='line-number'>46</span>
<span class='line-number'>47</span>
<span class='line-number'>48</span>
<span class='line-number'>49</span>
<span class='line-number'>50</span>
<span class='line-number'>51</span>
<span class='line-number'>52</span>
<span class='line-number'>53</span>
<span class='line-number'>54</span>
<span class='line-number'>55</span>
<span class='line-number'>56</span>
<span class='line-number'>57</span>
<span class='line-number'>58</span>
<span class='line-number'>59</span>
<span class='line-number'>60</span>
<span class='line-number'>61</span>
<span class='line-number'>62</span>
<span class='line-number'>63</span>
<span class='line-number'>64</span>
<span class='line-number'>65</span>
</pre></td><td class='code'><pre><code class='kotlin'><span class='line'><span class="c1">// Add the OptIn annotation at the top of your function or class</span>
</span><span class='line'>
</span><span class='line'><span class="n">@kotlin</span><span class="p">.</span><span class="n">OptIn</span><span class="p">(</span><span class="n">ExperimentalSessionConfig</span><span class="o">::</span><span class="k">class</span><span class="p">,</span> <span class="n">ExperimentalHighSpeedVideo</span><span class="o">::</span><span class="k">class</span><span class="p">)</span>
</span><span class='line'>
</span><span class='line'><span class="k">private</span> <span class="n">suspend</span> <span class="k">fun</span> <span class="nf">setupCamera</span><span class="p">()</span> <span class="p">{</span>
</span><span class='line'>
</span><span class='line'>    <span class="c1">// Asynchronously get the CameraProvider</span>
</span><span class='line'>
</span><span class='line'>    <span class="k">val</span> <span class="py">cameraProvider</span> <span class="p">=</span> <span class="n">ProcessCameraProvider</span><span class="p">.</span><span class="n">awaitInstance</span><span class="p">(</span><span class="k">this</span><span class="p">)</span>
</span><span class='line'>
</span><span class='line'>
</span><span class='line'>    <span class="c1">// -- CHECK CAPABILITIES --</span>
</span><span class='line'>
</span><span class='line'>    <span class="k">val</span> <span class="py">cameraInfo</span> <span class="p">=</span> <span class="n">cameraProvider</span><span class="p">.</span><span class="n">getCameraInfo</span><span class="p">(</span><span class="n">CameraSelector</span><span class="p">.</span><span class="n">DEFAULT_BACK_CAMERA</span><span class="p">)</span>
</span><span class='line'>
</span><span class='line'>    <span class="k">val</span> <span class="py">videoCapabilities</span> <span class="p">=</span> <span class="n">Recorder</span><span class="p">.</span><span class="n">getHighSpeedVideoCapabilities</span><span class="p">(</span><span class="n">cameraInfo</span><span class="p">)</span>
</span><span class='line'>
</span><span class='line'>    <span class="k">if</span> <span class="p">(</span><span class="n">videoCapabilities</span> <span class="p">==</span> <span class="k">null</span><span class="p">)</span> <span class="p">{</span>
</span><span class='line'>
</span><span class='line'>        <span class="c1">// This camera device does not support high-speed video.</span>
</span><span class='line'>
</span><span class='line'>        <span class="k">return</span>
</span><span class='line'>
</span><span class='line'>    <span class="p">}</span>
</span><span class='line'>
</span><span class='line'>
</span><span class='line'>    <span class="c1">// -- CREATE USE CASES --</span>
</span><span class='line'>
</span><span class='line'>    <span class="k">val</span> <span class="py">preview</span> <span class="p">=</span> <span class="n">Preview</span><span class="p">.</span><span class="n">Builder</span><span class="p">().</span><span class="n">build</span><span class="p">()</span>
</span><span class='line'>
</span><span class='line'>
</span><span class='line'>    <span class="c1">// You can create a Recorder with default settings.</span>
</span><span class='line'>
</span><span class='line'>    <span class="c1">// CameraX will automatically select a suitable quality.</span>
</span><span class='line'>
</span><span class='line'>    <span class="k">val</span> <span class="py">recorder</span> <span class="p">=</span> <span class="n">Recorder</span><span class="p">.</span><span class="n">Builder</span><span class="p">().</span><span class="n">build</span><span class="p">()</span>
</span><span class='line'>
</span><span class='line'>
</span><span class='line'>    <span class="c1">// Alternatively, to use a specific resolution, you can configure the</span>
</span><span class='line'>    <span class="c1">// Recorder with a QualitySelector. This is useful if your app has</span>
</span><span class='line'>    <span class="c1">// specific resolution requirements or you want to offer user</span>
</span><span class='line'>    <span class="c1">// preferences. </span>
</span><span class='line'>
</span><span class='line'>    <span class="c1">// To use a specific quality, you can uncomment the following lines.</span>
</span><span class='line'>
</span><span class='line'>    <span class="c1">// Get the list of qualities supported for high-speed video. </span>
</span><span class='line'>
</span><span class='line'>    <span class="c1">// val supportedQualities = videoCapabilities.getSupportedQualities(DynamicRange.SDR)</span>
</span><span class='line'>
</span><span class='line'>    <span class="c1">// Build the Recorder using the quality from the supported list.</span>
</span><span class='line'>
</span><span class='line'>    <span class="c1">// val recorderWithQuality = Recorder.Builder()</span>
</span><span class='line'>
</span><span class='line'>    <span class="c1">//     .setQualitySelector(QualitySelector.from(supportedQualities.first()))</span>
</span><span class='line'>
</span><span class='line'>    <span class="c1">//     .build()</span>
</span><span class='line'>
</span><span class='line'>
</span><span class='line'>    <span class="c1">// Create the VideoCapture use case, using either recorder or recorderWithQuality</span>
</span><span class='line'>
</span><span class='line'>    <span class="k">val</span> <span class="py">videoCapture</span> <span class="p">=</span> <span class="n">VideoCapture</span><span class="p">.</span><span class="n">withOutput</span><span class="p">(</span><span class="n">recorder</span><span class="p">)</span>
</span><span class='line'>
</span><span class='line'>    <span class="c1">// Now you are ready to configure the session for your desired output...</span>
</span><span class='line'>
</span><span class='line'><span class="p">}</span>
</span></code></pre></td></tr></table></div></figure>


<h3>2. 选择输出</h3>

<p>现在，你需要决定要创建哪种类型的视频。此代码将在上面所示的 <code>setupCamera()suspend</code> 函数中运行。</p>

<h4>选项 A：创建高帧率视频</h4>

<p>如果你希望最终文件具有高帧率（例如，120fps 的视频），请选择此选项。</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
</pre></td><td class='code'><pre><code class='kotlin'><span class='line'><span class="c1">// Create a builder for the high-speed session</span>
</span><span class='line'>
</span><span class='line'><span class="k">val</span> <span class="py">sessionConfigBuilder</span> <span class="p">=</span> <span class="n">HighSpeedVideoSessionConfig</span><span class="p">.</span><span class="n">Builder</span><span class="p">(</span><span class="n">videoCapture</span><span class="p">)</span>
</span><span class='line'>
</span><span class='line'>    <span class="p">.</span><span class="n">setPreview</span><span class="p">(</span><span class="n">preview</span><span class="p">)</span>
</span><span class='line'>
</span><span class='line'>
</span><span class='line'><span class="c1">// Query and apply a supported frame rate. Common supported frame rates include 120 and 240 fps.</span>
</span><span class='line'>
</span><span class='line'><span class="k">val</span> <span class="py">supportedFrameRateRanges</span> <span class="p">=</span>
</span><span class='line'>
</span><span class='line'>    <span class="n">cameraInfo</span><span class="p">.</span><span class="n">getSupportedFrameRateRanges</span><span class="p">(</span><span class="n">sessionConfigBuilder</span><span class="p">.</span><span class="n">build</span><span class="p">())</span>
</span><span class='line'>
</span><span class='line'>
</span><span class='line'><span class="n">sessionConfigBuilder</span><span class="p">.</span><span class="n">setFrameRateRange</span><span class="p">(</span><span class="n">supportedFrameRateRanges</span><span class="p">.</span><span class="n">first</span><span class="p">())</span>
</span></code></pre></td></tr></table></div></figure>


<h4>选项 B：创建可直接播放的慢动作视频</h4>

<p>如果你希望视频在任何标准视频播放器中自动以慢动作播放，请选择此选项。</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
</pre></td><td class='code'><pre><code class='kotlin'><span class='line'><span class="c1">// Create a builder for the high-speed session</span>
</span><span class='line'>
</span><span class='line'><span class="k">val</span> <span class="py">sessionConfigBuilder</span> <span class="p">=</span> <span class="n">HighSpeedVideoSessionConfig</span><span class="p">.</span><span class="n">Builder</span><span class="p">(</span><span class="n">videoCapture</span><span class="p">)</span>
</span><span class='line'>
</span><span class='line'>    <span class="p">.</span><span class="n">setPreview</span><span class="p">(</span><span class="n">preview</span><span class="p">)</span>
</span><span class='line'>
</span><span class='line'>
</span><span class='line'><span class="c1">// This is the key: enable automatic slow-motion!</span>
</span><span class='line'>
</span><span class='line'><span class="n">sessionConfigBuilder</span><span class="p">.</span><span class="n">setSlowMotionEnabled</span><span class="p">(</span><span class="k">true</span><span class="p">)</span>
</span><span class='line'>
</span><span class='line'>
</span><span class='line'><span class="c1">// Query and apply a supported frame rate. Common supported frame rates include 120, 240, and 480 fps.</span>
</span><span class='line'>
</span><span class='line'><span class="k">val</span> <span class="py">supportedFrameRateRanges</span> <span class="p">=</span>
</span><span class='line'>
</span><span class='line'>   <span class="n">cameraInfo</span><span class="p">.</span><span class="n">getSupportedFrameRateRanges</span><span class="p">(</span><span class="n">sessionConfigBuilder</span><span class="p">.</span><span class="n">build</span><span class="p">())</span>
</span><span class='line'>
</span><span class='line'><span class="n">sessionConfigBuilder</span><span class="p">.</span><span class="n">setFrameRateRange</span><span class="p">(</span><span class="n">supportedFrameRateRanges</span><span class="p">.</span><span class="n">first</span><span class="p">())</span>
</span></code></pre></td></tr></table></div></figure>


<p>这个标志位是创建可直接播放的慢动作视频的关键。当 <code>setSlowMotionEnabled</code> 设置为 true 时，CameraX 会处理高速视频流并将其保存为标准的 30 fps 视频文件。慢动作播放速度由拍摄帧速率与标准播放速率的比值决定。</p>

<p>例如：</p>

<ul>
<li><p>以 120 fps 录制的视频将以 &frac14; 倍速播放 (120 ÷ 30 = 4)。</p></li>
<li><p>以 240 fps 录制的视频将以 1/8 倍速播放 (240 ÷ 30 = 8)。</p></li>
</ul>


<h2>整合所有步骤：录制视频</h2>

<p>配置好 HighSpeedVideoSessionConfig 并将其绑定到生命周期后，最后一步就是开始录制。准备输出选项、开始录制和处理视频事件的过程与标准视频捕获相同。</p>

<p>本文重点介绍高速配置，因此不会详细介绍录制过程。如需了解从准备 FileOutputOptions 或 MediaStoreOutputOptions 对象到处理 VideoRecordEvent 回调的完整指南，请参阅<a href="https://developer.android.com/media/camera/camerax/video-capture#videocapture-api-overview">VideoCapture 文档</a>。</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
</pre></td><td class='code'><pre><code class='kotlin'><span class='line'><span class="c1">// Bind the session config to the lifecycle</span>
</span><span class='line'>
</span><span class='line'><span class="n">cameraProvider</span><span class="p">.</span><span class="n">bindToLifecycle</span><span class="p">(</span>
</span><span class='line'>
</span><span class='line'>    <span class="k">this</span> <span class="k">as</span> <span class="n">LifecycleOwner</span><span class="p">,</span>
</span><span class='line'>
</span><span class='line'>    <span class="n">CameraSelector</span><span class="p">.</span><span class="n">DEFAULT_BACK_CAMERA</span><span class="p">,</span>
</span><span class='line'>
</span><span class='line'>    <span class="n">sessionConfigBuilder</span><span class="p">.</span><span class="n">build</span><span class="p">()</span> <span class="c1">// Bind the config object from Option A or B</span>
</span><span class='line'>
</span><span class='line'><span class="p">)</span>
</span><span class='line'>
</span><span class='line'>
</span><span class='line'><span class="c1">// Start the recording using the VideoCapture use case</span>
</span><span class='line'>
</span><span class='line'><span class="k">val</span> <span class="py">recording</span> <span class="p">=</span> <span class="n">videoCapture</span><span class="p">.</span><span class="n">output</span>
</span><span class='line'>
</span><span class='line'>    <span class="p">.</span><span class="n">prepareRecording</span><span class="p">(</span><span class="n">context</span><span class="p">,</span> <span class="n">outputOptions</span><span class="p">)</span> <span class="c1">// See docs for creating outputOptions</span>
</span><span class='line'>
</span><span class='line'>    <span class="p">.</span><span class="n">start</span><span class="p">(</span><span class="n">ContextCompat</span><span class="p">.</span><span class="n">getMainExecutor</span><span class="p">(</span><span class="n">context</span><span class="p">))</span> <span class="p">{</span> <span class="n">recordEvent</span> <span class="p">-&gt;</span>
</span><span class='line'>
</span><span class='line'>        <span class="c1">// Handle recording events (e.g., Start, Pause, Finalize)</span>
</span><span class='line'>
</span><span class='line'>    <span class="p">}</span>
</span></code></pre></td></tr></table></div></figure>


<h2>Google Photos 对慢动作视频的支持</h2>

<p>在 CameraX 中启用 setSlowMotionEnabled(true) 后，生成的视频文件将被设计为可在标准视频播放器和图库应用中立即识别并播放为慢动作视频。谷歌相册尤其针对慢动作视频提供了增强功能，当拍摄帧速率为 120、240、360、480 或 960fps 时，功能更加完善：</p>

<ul>
<li>缩略图中的独特 UI 识别：在谷歌相册中，慢动作视频会通过特定的 UI 元素进行识别，从而与普通视频区分开来。</li>
</ul>


<p><img src="https://blogger.googleusercontent.com/img/a/AVvXsEjPLQRSSF3hvj89T9DvO92-JNi_rjtUXQ-i76ZuyX4GHv4KitBFPVP5oHdqxICQJUf3l7HaOQeI0skgVK9bPM0qz7GToNYiIMszVYj6IsE4-wGa4jqZfYka03TTlFwUTDdYq56unwoIwv1fTnJrNpWIZ-5Iybgk-hFHlvcy08Bkm8xM0adbvYjqVxH12xc" alt="普通视频缩略图" /></p>

<p><img src="https://blogger.googleusercontent.com/img/a/AVvXsEiDmd0jikxU58PkjrGG1K181pYs-G-drnrNG_q_mQqVJWkK4NdbuwDSB4jCbQzGAgYeyikORVsPT3pyQp_VCfw_7rNDzafFudhj0x56-bqNZc6mQuRktDCa7ycSx2-qsIJsCCTiQXmxxrtImiBOFwlTz3ufBtbGDsonZvqzSQqWbNugNt-bbDVvyQz7Hw8" alt="慢动作视频缩略图" /></p>

<ul>
<li>播放时可调整速度：播放慢动作视频时，Google Photos 提供控制选项，允许用户调整视频中哪些部分以慢速播放，哪些部分以正常速度播放，从而赋予用户更大的创作自由。编辑后的视频可以使用“分享”按钮导出为新的视频文件，同时保留你定义的慢动作片段。</li>
</ul>


<p><img src="https://blogger.googleusercontent.com/img/a/AVvXsEj-dp-bHPORhk_l0I4zkSEdzYUNRYvRwb2boA4KKgd1s4Sr1D61iAV2rWUD6dOdVezRn10qIGtMLae4brWI8RxlP9wFz18gsrZu4qOdAydWnhqgpmmsuLcHAMfo5Rv6XZIxtTCC5dSJeIJERbOKmPZyUXTOdweJ6EjQett5iOVl4yJzaLYR7rrHXz0WnAI" alt="正常视频播放" /></p>

<p><img src="https://blogger.googleusercontent.com/img/a/AVvXsEi4AaVc78zpZzsG-hgOsuPdAqwCuSD6bb1b6de366Agvy2c3OG5qJ5mSPg94GA8GjR-LXDU4H7zBCoI_Pe3SxrfdDPiTyPmimTRM49IcTkGovC2mccTu0GnwcSyVAL5iW7qnNlWHGCoGHU9EeX3-8bZiSsmLWr6Ljf5KfJjInUuCEODrqF-g8Je3iLvEF4" alt="慢动作视频播放（带编辑控制）" /></p>

<h2>关于设备支持的说明</h2>

<p>CameraX 的高速 API 依赖于底层 Android 的 <a href="https://developer.android.com/reference/android/media/CamcorderProfile">CamcorderProfile</a> 系统来确定设备支持的高速分辨率和帧速率。CamcorderProfile 经过 <a href="https://source.android.com/docs/compatibility/cts">Android 兼容性测试套件 (CTS)</a> 的验证，这意味着你可以信赖设备所报告的视频录制功能。</p>

<p>这意味着，设备内置相机应用能够录制慢动作视频并不能保证 CameraX 高速 API 能够正常工作。出现这种差异的原因是，设备制造商负责在其设备固件中填充 CamcorderProfile 条目，而有时必要的高速配置文件（例如 CamcorderProfile.QUALITY_HIGH_SPEED_1080P 和 CamcorderProfile.QUALITY_HIGH_SPEED_720P）可能并未包含在内。当缺少这些配置文件时，<code>Recorder.getHighSpeedVideoCapabilities()</code> 将返回 null。</p>

<p>因此，务必始终使用 <code>Recorder.getHighSpeedVideoCapabilities()</code> 以编程方式检查支持的功能，因为这是确保在不同设备上获得一致体验的最可靠方法。如果尝试在 <code>Recorder.getHighSpeedVideoCapabilities()</code> 返回 null 的设备上绑定 <code>HighSpeedVideoSessionConfig</code>，则操作将失败并抛出 <code>IllegalArgumentException</code> 异常。你可以在 Google Pixel 设备上确认支持，因为它们始终包含这些高速配置文件。此外，其他制造商的各种设备，例如 Motorola Edge 30、OPPO Find N2 Flip 和 Sony Xperia 1 V，也支持高速视频功能。</p>

<h2>结论</h2>

<p>CameraX 高速视频 API 功能强大且灵活。无论你是需要用于技术分析的真正高帧率视频素材，还是想为你的应用添加电影级的慢动作效果，HighSpeedVideoSessionConfig 都能提供统一且简便的解决方案。通过了解 setSlowMotionEnabled 标志的作用，你可以轻松支持这两种使用场景，并赋予用户更大的创作自由。</p>
</div>


  <footer>
    <p class="meta">
      
  

<span class="byline author vcard">Posted by <span class="fn">Alex Hilton</span></span>

      




<time class='entry-date' datetime='2025-11-05T21:59:12+08:00'><span class='date'><span class='date-month'>Nov</span> <span class='date-day'>5</span><span class='date-suffix'>th</span>, <span class='date-year'>2025</span></span> <span class='time'>9:59 pm</span></time>
      

<span class="categories">
  
    <a class='category' href='/blog/categories/effectiveandroid/'>effectiveandroid</a>
  
</span>


    </p>
    
      <div class="sharing">
  
  
  
  
    <!-- JiaThis Button BEGIN -->
<div class="jiathis_style_32x32">
	<a class="jiathis_button_qzone"></a>
	<a class="jiathis_button_tsina"></a>
	<a class="jiathis_button_tqq"></a>
	<a class="jiathis_button_weixin"></a>
	<a class="jiathis_button_renren"></a>
	<a href="http://www.jiathis.com/share" class="jiathis jiathis_txt jtico jtico_jiathis" target="_blank"></a>
	<a class="jiathis_counter_style"></a>
</div>
<script type="text/javascript" src="http://v3.jiathis.com/code/jia.js" charset="utf-8"></script>
<!-- JiaThis Button END -->

  
</div>

    
    <p class="meta">
      
        <a class="basic-alignment left" href="/blog/2025/11/02/compose-camerax-is-stable/" title="Previous Post: Compose CameraX现已稳定：给Composer的端到端指南">&laquo; Compose CameraX现已稳定：给Composer的端到端指南</a>
      
      
    </p>
  </footer>
</article>

  <section>
    <h1>Comments</h1>
    <div id="comments"></div>
    <!-- Duoshuo COMMENT BEGIN -->
<script src="https://imsun.github.io/gitment/dist/gitment.browser.js"></script>
<script>
    var clientId = 'bc66a01ef24d14fc282b'
    var clientSecret = 'c7fd5e55db1776204fe201fe20c050b140982884'
    var gitment = new Gitment({
      id: 'toughcoder.net',
      owner: 'alexhilton',
      repo: 'alexhilton.github.io',
      oauth: {
        client_id: clientId,
        client_secret: clientSecret,
      },
    })

    gitment.render('comments')
</script>
<!-- Duoshuo COMMENT END -->

  </section>

</div>

<aside class="sidebar">
  
    <section>
    <div class="
        col-lg-2 col-lg-offset-0
        visible-lg-block
        sidebar-container
        catalog-container">
        <div class="side-catalog">
            <hr class="hidden-sm hidden-xs">
            <h3>
                <a class="catalog-toggle" href="#">CATALOG</a>
            </h3>
            <ul class="catalog-body"></ul>
        </div>
    </div>
</section>
<!-- Back to top and Scroll to bottom -->
<a href="#" class="cd-top"></a>
<a href="#" class="cd-bottom"></a>

  
</aside>


    </div>
  </div>
  <footer role="contentinfo"><p>
  Copyright &copy; 2025 - Alex Hilton -
  <span class="credit">Powered by <a href="http://octopress.org">Octopress</a></span>
</p>

</footer>
  









<script type="text/javascript">
    //async load function 
    function async(u, c) {
        var d = document, t = 'script',
            o = d.createElement(t),
            s = d.getElementsByTagName(t)[0];
        o.src = u;
        if (c) { o.addEventListener('load', function (e) { c(null, e); }, false); }
        s.parentNode.insertBefore(o, s);
    }

    function generateCatalog (selector) {
        var P = $('article'),a,n,t,l,i,c, id;
        a = P.find('h2,h3,h4,h5,h6');
        var index = 0;
        a.each(function () {
            n = $(this).prop('tagName').toLowerCase();
            id = $(this).prop('id');
            if (!id) {
                var nid = 'catalog-section-' + index;
                $(this).attr('id', nid);
                i = '#' + nid;
            } else {
                i = '#' + id;
            }
            t = $(this).text();
            c = $('<a href="'+i+'" rel="nofollow">'+t+'</a>');
            l = $('<li class="'+n+'_nav"></li>').append(c);
            $(selector).append(l);
            index++;
        });
        return true;
    }

    generateCatalog(".catalog-body");

    // toggle side catalog
    $(".catalog-toggle").click((function(e){
        e.preventDefault();
        $('.side-catalog').toggleClass("fold")
    }))

    /*
     * Doc: https://github.com/davist11/jQuery-One-Page-Nav
     * Fork by Hux to support padding
     */
    async("/javascripts/jquery.nav.js", function () {
        $('.catalog-body').onePageNav({
            currentClass: "active",
            changeHash: !1,
            easing: "swing",
            filter: "",
            scrollSpeed: 700,
            scrollOffset: 0,
            scrollThreshold: .2,
            begin: null,
            end: null,
            scrollChange: null,
            padding: 80
        });
    });

// Navigation Scripts to Show Header on Scroll-Up
jQuery(document).ready(function($) {
    var MQL = 1170;

    //primary navigation slide-in effect
    if ($(window).width() > MQL) {
        // We do not have the sticky nav bar so, first can be zero
        var headerHeight = 0;
        $('nav').each(function() {
            var h = $(this).outerHeight(true);
            headerHeight += h;
        });
        $('header').each(function() {
            var h = $(this).outerHeight(true);
            headerHeight += h;
        });
        $(window).on('scroll', {
                previousTop: 0
            },
            function() {
                var currentTop = $(window).scrollTop(),
                    $catalog = $('.side-catalog');

                this.previousTop = currentTop;

                //adjust the appearance of side-catalog
                $catalog.show()
                if (currentTop > (headerHeight + 42)) {
                    $catalog.addClass('fixed')
                } else {
                    $catalog.removeClass('fixed')
                }
            });
    }
});
</script>

<script>
var _hmt = _hmt || [];
(function() {
  var hm = document.createElement("script");
  hm.src = "https://hm.baidu.com/hm.js?3fab3b1bae08e6d4a5e638d9e8c6f40a";
  var s = document.getElementsByTagName("script")[0];
  s.parentNode.insertBefore(hm, s);
})();
</script>


</body>
</html>
