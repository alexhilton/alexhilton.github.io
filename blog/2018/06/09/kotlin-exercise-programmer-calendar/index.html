
<!DOCTYPE html>
<!--[if IEMobile 7 ]><html class="no-js iem7"><![endif]-->
<!--[if lt IE 9]><html class="no-js lte-ie8"><![endif]-->
<!--[if (gt IE 8)|(gt IEMobile 7)|!(IEMobile)|!(IE)]><!--><html class="no-js" lang="en"><!--<![endif]-->
<head>
  <meta charset="utf-8">
  <title>Kotlin实战学习：撸一个程序猿老黄历 - 稀有猿诉</title>
  <meta name="author" content="Alex Hilton">

  
  <meta name="description" content="展示如何用Kotlin开发一个简单的应用，撸一个程序猿老黄历来展示如何用Kotlin来写布局。">
  <meta name="keywords" content="Kotlin, Android, Android app, 程序猿老黄历, Programmer Calendar">

  <!-- http://t.co/dKP3o1e -->
  <meta name="HandheldFriendly" content="True">
  <meta name="MobileOptimized" content="320">
  <meta name="viewport" content="width=device-width, initial-scale=1">

  
  <link rel="canonical" href="http://toughcoder.net/blog/2018/06/09/kotlin-exercise-programmer-calendar">
  <link href="/favicon.png" rel="icon">
  <link href="/stylesheets/screen.css" media="screen, projection" rel="stylesheet" type="text/css">
  <link href="/atom.xml" rel="alternate" title="稀有猿诉" type="application/atom+xml">
  <script src="/javascripts/modernizr-2.0.js"></script>
  <script src="http://libs.baidu.com/jquery/1.9.1/jquery.min.js"></script>
  <script>!window.jQuery && document.write(unescape('%3Cscript src="./javascripts/libs/jquery.min.js"%3E%3C/script%3E'))</script>
  <script src="/javascripts/octopress.js" type="text/javascript"></script>
  <script src="/javascripts/toolbar.js" type="text/javascript"></script>
  <!--Fonts from Google"s Web font directory at http://google.com/webfonts -->
<link href="//fonts.lug.ustc.edu.cn/css?family=PT+Serif:regular,italic,bold,bolditalic" rel="stylesheet" type="text/css">
<link href="//fonts.lug.ustc.edu.cn/css?family=PT+Sans:regular,italic,bold,bolditalic" rel="stylesheet" type="text/css">

<!-- for Gitment -->
<link rel="stylesheet" href="https://imsun.github.io/gitment/style/default.css">

<!-- for favicon -->
<link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png">
<link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png">
<link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png">
<link rel="manifest" href="/site.webmanifest">
<link rel="mask-icon" href="/safari-pinned-tab.svg" color="#5bbad5">
<meta name="msapplication-TileColor" content="#da532c">
<meta name="theme-color" content="#ffffff">

  

</head>

<body   >
  <header role="banner"><hgroup>
  <h1><a href="/">稀有猿诉</a></h1>
  
    <h2>十年磨一剑，历炼出锋芒，说话千百句，不如码二行。</h2>
  
</hgroup>

</header>
  <nav role="navigation"><ul class="subscription" data-subscription="rss">
  <li><a href="/atom.xml" rel="subscribe-rss" title="subscribe via RSS">RSS</a></li>
  
</ul>
  
<form action="https://www.google.com.hk/search" method="get">
  <fieldset role="search">
    <input type="hidden" name="q" value="site:toughcoder.net" />
    <input class="search" type="text" name="q" results="0" placeholder="Search"/>
  </fieldset>
</form>
  
<ul class="main-navigation">
  <li><a href="/">Home</a></li>
  <li><a href="/blog/archives">Archives</a></li>
  <li><a href="/donation">Donation</a></li>
  <li><a href="/about">About</a></li>
</ul>

</nav>
  <div id="main">
    <div id="content">
      <div>
<article class="hentry" role="article">
  
  <header>
    
      <h1 class="entry-title">Kotlin实战学习：撸一个程序猿老黄历</h1>
    
    
      <p class="meta">
        




<time class='entry-date' datetime='2018-06-09T16:10:24+08:00'><span class='date'><span class='date-month'>Jun</span> <span class='date-day'>9</span><span class='date-suffix'>th</span>, <span class='date-year'>2018</span></span> <span class='time'>4:10 pm</span></time>
        
      </p>
    
  </header>


<div class="entry-content"><h2>Talk is cheap, let&rsquo;s code</h2>

<p><a href="http://toughcoder.net/blog/2018/05/17/introduction-to-kotlin-programming-language/">前面一篇文章</a>介绍Kotlin的基础知识，但光有知识是不够的，最重要的是要能在实战中使用Kotlin，这才不枉我们学习一回。这里就用纯Kotlin来开发一个简单的Android应用，以展示如何在实际项目中使用Kotlin。</p>

<p><a href="/blog/2018/06/09/kotlin-exercise-programmer-calendar/"><img src="https://www.rootinfosol.com/sites/default/files/2017-05/Android%20kotlin%20banner.jpg" width="640"></a></p>

<h2>走上Kotlin开发之路</h2>

<p>在前面文章的尾部，我们展示了如何创建一个基于Kotlin安卓应用，但是过于简单，因为仅是代码换成了Kotlin，布局还是在用XML，这并没有用到Kotlin的全部。为了更加方便的开发Android应用，发挥Kotlin语言的巨大优势，JetBrains在发布Kotlin的同时，也发布一个专门用于Android开发的配套的库Anko，它最大的优势就是以DSL的方式来创建UI，下面我们来介绍一下Anko。</p>

<!-- more -->


<h2><a href="https://github.com/Kotlin/anko">Anko</a></h2>

<h3>Anko是什么鬼，以及为何要用它</h3>

<p>Anko库的目的是提高Android开发的效率，用Kotlin语言的优势。它有四大部分：Anko commons，Anko layouts，Anko SQLite和Anko Coroutines，这里我们不复制官方的介绍了，关于这四部分可以看一下官方的<a href="https://github.com/Kotlin/anko">wiki</a>。
其实，最大的变化就是布局，常规的Android项目，我们一般都是用XML来写布局XML呢，其实也没有啥大问题，在各种开发工具和开源库的帮忙下，效率也不低，但XML最大的问题就是啰嗦，要不然现在也不会被JSON取代。
当然，我们可以像前面的KotlinHello，显示的那样，布局使用XML，代码使用Kotlin，这没有任何问题，但Kotlin语言最大的特点是简洁，所以，使用Anko可以，非常简洁的，用更少的代码来实现同样的功能，代码少了，效率也就高了。</p>

<h3>如何使用Anko</h3>

<p>重写KotlinHello，来展示一下如何在项目中使用Anko，继续打开上篇文章中的KotlinHello项目，在app下面的build.gradle中的dependencies中添加：</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class='kotlin'><span class='line'><span class="n">implementation</span> <span class="s">&quot;org.jetbrains.anko:anko:$anko_version&quot;</span>
</span></code></pre></td></tr></table></div></figure>


<p>在其顶部定义anko_version变量：</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class='kotlin'><span class='line'><span class="n">ext</span><span class="p">.</span><span class="n">anko_version</span> <span class="p">=</span> <span class="err">&#39;</span><span class="m">0.10</span><span class="p">.</span><span class="m">5</span><span class="err">&#39;</span>
</span></code></pre></td></tr></table></div></figure>


<p>重新gradle sync一下，完成后，就可以使用了。</p>

<p>编辑HelloActivity.kt，在onCreate里面，把除了super.onCreate以外的都删除，然后添加：</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
</pre></td><td class='code'><pre><code class='kotlin'><span class='line'>    <span class="k">val</span> <span class="py">colorTable</span> <span class="p">=</span> <span class="n">listOf</span><span class="p">(</span><span class="s">&quot;#ff0000&quot;</span><span class="p">,</span> <span class="s">&quot;#00ff00&quot;</span><span class="p">,</span> <span class="s">&quot;#0000ff&quot;</span><span class="p">,</span> <span class="s">&quot;#ffff00&quot;</span><span class="p">,</span> <span class="s">&quot;#00ffff&quot;</span><span class="p">,</span> <span class="s">&quot;#ff00ff&quot;</span><span class="p">)</span>
</span><span class='line'>
</span><span class='line'>    <span class="n">verticalLayout</span> <span class="p">{</span>
</span><span class='line'>        <span class="k">val</span> <span class="py">name</span> <span class="p">=</span> <span class="n">editText</span><span class="p">()</span>
</span><span class='line'>        <span class="n">button</span><span class="p">(</span><span class="s">&quot;Say Hello&quot;</span><span class="p">)</span> <span class="p">{</span>
</span><span class='line'>            <span class="n">onClick</span> <span class="p">{</span>
</span><span class='line'>                <span class="k">val</span> <span class="py">randomIndex</span> <span class="p">=</span> <span class="p">(</span><span class="n">Math</span><span class="p">.</span><span class="n">random</span><span class="p">()</span> <span class="p">*</span> <span class="n">colorTable</span><span class="p">.</span><span class="n">size</span><span class="p">).</span><span class="n">toInt</span><span class="p">()</span>
</span><span class='line'>                <span class="n">setBackgroundColor</span><span class="p">(</span><span class="n">Color</span><span class="p">.</span><span class="n">parseColor</span><span class="p">(</span><span class="n">colorTable</span><span class="p">[</span><span class="n">randomIndex</span><span class="p">]))</span>
</span><span class='line'>                <span class="n">toast</span><span class="p">(</span><span class="s">&quot;Hello, ${name.text}! with color ${colorTable[randomIndex]}&quot;</span><span class="p">)</span>
</span><span class='line'>            <span class="p">}</span>
</span><span class='line'>        <span class="p">}</span>
</span><span class='line'>    <span class="p">}</span>
</span></code></pre></td></tr></table></div></figure>


<p>运行起来，就是这个样子的：</p>

<p><img src="https://wx3.sinaimg.cn/mw690/870ad0baly1fs57e1fmtpg20a00k0dgi.gif" alt="Kotlin Hello version 1" /></p>

<p>页面有点丑，稍美化下，展示如何添加布局的属性：</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
</pre></td><td class='code'><pre><code class='kotlin'><span class='line'>        <span class="n">padding</span> <span class="p">=</span> <span class="n">dip</span><span class="p">(</span><span class="m">20</span><span class="p">)</span>
</span><span class='line'>        <span class="k">val</span> <span class="py">name</span> <span class="p">=</span> <span class="n">editText</span><span class="p">()</span>
</span><span class='line'>        <span class="n">name</span><span class="p">.</span><span class="n">lparams</span><span class="p">(</span><span class="n">width</span> <span class="p">=</span> <span class="n">matchParent</span><span class="p">)</span> <span class="p">{</span>
</span><span class='line'>            <span class="n">topMargin</span> <span class="p">=</span> <span class="n">dip</span><span class="p">(</span><span class="m">20</span><span class="p">)</span>
</span><span class='line'>            <span class="n">bottomMargin</span> <span class="p">=</span> <span class="n">dip</span><span class="p">(</span><span class="m">30</span><span class="p">)</span>
</span><span class='line'>        <span class="p">}</span>
</span></code></pre></td></tr></table></div></figure>


<p>最终就是这个样子了：</p>

<p><img src="https://wx4.sinaimg.cn/mw690/870ad0baly1fs57e1foj9g20a00k0js2.gif" alt="Kotlin Hello version 2" /></p>

<p>贴下完整代码：
app/build.gradle:</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
<span class='line-number'>25</span>
<span class='line-number'>26</span>
<span class='line-number'>27</span>
<span class='line-number'>28</span>
<span class='line-number'>29</span>
<span class='line-number'>30</span>
<span class='line-number'>31</span>
<span class='line-number'>32</span>
<span class='line-number'>33</span>
<span class='line-number'>34</span>
<span class='line-number'>35</span>
<span class='line-number'>36</span>
</pre></td><td class='code'><pre><code class='kotlin'><span class='line'><span class="n">apply</span> <span class="n">plugin</span><span class="p">:</span> <span class="err">&#39;</span><span class="n">com</span><span class="p">.</span><span class="n">android</span><span class="p">.</span><span class="n">application</span><span class="err">&#39;</span>
</span><span class='line'>
</span><span class='line'><span class="n">apply</span> <span class="n">plugin</span><span class="p">:</span> <span class="err">&#39;</span><span class="n">kotlin</span><span class="p">-</span><span class="n">android</span><span class="err">&#39;</span>
</span><span class='line'>
</span><span class='line'><span class="n">apply</span> <span class="n">plugin</span><span class="p">:</span> <span class="err">&#39;</span><span class="n">kotlin</span><span class="p">-</span><span class="n">android</span><span class="p">-</span><span class="n">extensions</span><span class="err">&#39;</span>
</span><span class='line'>
</span><span class='line'><span class="n">ext</span><span class="p">.</span><span class="n">anko_version</span> <span class="p">=</span> <span class="err">&#39;</span><span class="m">0.10</span><span class="p">.</span><span class="m">5</span><span class="err">&#39;</span>
</span><span class='line'>
</span><span class='line'><span class="n">android</span> <span class="p">{</span>
</span><span class='line'>    <span class="n">compileSdkVersion</span> <span class="m">27</span>
</span><span class='line'>    <span class="n">defaultConfig</span> <span class="p">{</span>
</span><span class='line'>        <span class="n">applicationId</span> <span class="s">&quot;net.toughcoder.kotlinhello&quot;</span>
</span><span class='line'>        <span class="n">minSdkVersion</span> <span class="m">21</span>
</span><span class='line'>        <span class="n">targetSdkVersion</span> <span class="m">27</span>
</span><span class='line'>        <span class="n">versionCode</span> <span class="m">1</span>
</span><span class='line'>        <span class="n">versionName</span> <span class="s">&quot;1.0&quot;</span>
</span><span class='line'>        <span class="n">testInstrumentationRunner</span> <span class="s">&quot;android.support.test.runner.AndroidJUnitRunner&quot;</span>
</span><span class='line'>    <span class="p">}</span>
</span><span class='line'>    <span class="n">buildTypes</span> <span class="p">{</span>
</span><span class='line'>        <span class="n">release</span> <span class="p">{</span>
</span><span class='line'>            <span class="n">minifyEnabled</span> <span class="k">false</span>
</span><span class='line'>            <span class="n">proguardFiles</span> <span class="n">getDefaultProguardFile</span><span class="p">(</span><span class="err">&#39;</span><span class="n">proguard</span><span class="p">-</span><span class="n">android</span><span class="p">.</span><span class="n">txt</span><span class="err">&#39;</span><span class="p">),</span> <span class="err">&#39;</span><span class="n">proguard</span><span class="p">-</span><span class="n">rules</span><span class="p">.</span><span class="n">pro</span><span class="err">&#39;</span>
</span><span class='line'>        <span class="p">}</span>
</span><span class='line'>    <span class="p">}</span>
</span><span class='line'><span class="p">}</span>
</span><span class='line'>
</span><span class='line'><span class="n">dependencies</span> <span class="p">{</span>
</span><span class='line'>    <span class="n">implementation</span> <span class="n">fileTree</span><span class="p">(</span><span class="n">dir</span><span class="p">:</span> <span class="err">&#39;</span><span class="n">libs</span><span class="err">&#39;</span><span class="p">,</span> <span class="n">include</span><span class="p">:</span> <span class="p">[</span><span class="err">&#39;</span><span class="p">*.</span><span class="n">jar</span><span class="err">&#39;</span><span class="p">])</span>
</span><span class='line'>    <span class="n">implementation</span><span class="s">&quot;org.jetbrains.kotlin:kotlin-stdlib-jre7:$kotlin_version&quot;</span>
</span><span class='line'>    <span class="n">implementation</span> <span class="err">&#39;</span><span class="n">com</span><span class="p">.</span><span class="n">android</span><span class="p">.</span><span class="n">support</span><span class="p">:</span><span class="n">appcompat</span><span class="p">-</span><span class="n">v7</span><span class="p">:</span><span class="m">27.1</span><span class="p">.</span><span class="m">1</span><span class="err">&#39;</span>
</span><span class='line'>    <span class="n">implementation</span> <span class="err">&#39;</span><span class="n">com</span><span class="p">.</span><span class="n">android</span><span class="p">.</span><span class="n">support</span><span class="p">.</span><span class="n">constraint</span><span class="p">:</span><span class="n">constraint</span><span class="p">-</span><span class="n">layout</span><span class="p">:</span><span class="m">1.1</span><span class="p">.</span><span class="m">0</span><span class="err">&#39;</span>
</span><span class='line'>    <span class="n">implementation</span> <span class="s">&quot;org.jetbrains.anko:anko:$anko_version&quot;</span>
</span><span class='line'>    <span class="n">testImplementation</span> <span class="err">&#39;</span><span class="n">junit</span><span class="p">:</span><span class="n">junit</span><span class="p">:</span><span class="m">4.12</span><span class="err">&#39;</span>
</span><span class='line'>    <span class="n">androidTestImplementation</span> <span class="err">&#39;</span><span class="n">com</span><span class="p">.</span><span class="n">android</span><span class="p">.</span><span class="n">support</span><span class="p">.</span><span class="n">test</span><span class="p">:</span><span class="n">runner</span><span class="p">:</span><span class="m">1.0</span><span class="p">.</span><span class="m">2</span><span class="err">&#39;</span>
</span><span class='line'>    <span class="n">androidTestImplementation</span> <span class="err">&#39;</span><span class="n">com</span><span class="p">.</span><span class="n">android</span><span class="p">.</span><span class="n">support</span><span class="p">.</span><span class="n">test</span><span class="p">.</span><span class="n">espresso</span><span class="p">:</span><span class="n">espresso</span><span class="p">-</span><span class="n">core</span><span class="p">:</span><span class="m">3.0</span><span class="p">.</span><span class="m">2</span><span class="err">&#39;</span>
</span><span class='line'><span class="p">}</span>
</span></code></pre></td></tr></table></div></figure>


<p>HelloActivity.kt:</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
</pre></td><td class='code'><pre><code class='kotlin'><span class='line'><span class="k">class</span> <span class="nc">HelloActivity</span> <span class="p">:</span> <span class="n">AppCompatActivity</span><span class="p">()</span> <span class="p">{</span>
</span><span class='line'>    <span class="k">override</span> <span class="k">fun</span> <span class="nf">onCreate</span><span class="p">(</span><span class="n">savedInstanceState</span><span class="p">:</span> <span class="n">Bundle</span><span class="p">?)</span> <span class="p">{</span>
</span><span class='line'>        <span class="k">super</span><span class="p">.</span><span class="n">onCreate</span><span class="p">(</span><span class="n">savedInstanceState</span><span class="p">)</span>
</span><span class='line'>
</span><span class='line'>        <span class="k">val</span> <span class="py">colorTable</span> <span class="p">=</span> <span class="n">listOf</span><span class="p">(</span><span class="s">&quot;#ff0000&quot;</span><span class="p">,</span> <span class="s">&quot;#00ff00&quot;</span><span class="p">,</span> <span class="s">&quot;#0000ff&quot;</span><span class="p">,</span> <span class="s">&quot;#ffff00&quot;</span><span class="p">,</span> <span class="s">&quot;#00ffff&quot;</span><span class="p">,</span> <span class="s">&quot;#ff00ff&quot;</span><span class="p">)</span>
</span><span class='line'>
</span><span class='line'>        <span class="n">verticalLayout</span> <span class="p">{</span>
</span><span class='line'>            <span class="n">padding</span> <span class="p">=</span> <span class="n">dip</span><span class="p">(</span><span class="m">20</span><span class="p">)</span>
</span><span class='line'>            <span class="k">val</span> <span class="py">name</span> <span class="p">=</span> <span class="n">editText</span><span class="p">()</span>
</span><span class='line'>            <span class="n">name</span><span class="p">.</span><span class="n">lparams</span><span class="p">(</span><span class="n">width</span> <span class="p">=</span> <span class="n">matchParent</span><span class="p">)</span> <span class="p">{</span>
</span><span class='line'>                <span class="n">topMargin</span> <span class="p">=</span> <span class="n">dip</span><span class="p">(</span><span class="m">20</span><span class="p">)</span>
</span><span class='line'>                <span class="n">bottomMargin</span> <span class="p">=</span> <span class="n">dip</span><span class="p">(</span><span class="m">30</span><span class="p">)</span>
</span><span class='line'>            <span class="p">}</span>
</span><span class='line'>            <span class="n">button</span><span class="p">(</span><span class="s">&quot;Say Hello&quot;</span><span class="p">)</span> <span class="p">{</span>
</span><span class='line'>                <span class="n">onClick</span> <span class="p">{</span>
</span><span class='line'>                    <span class="k">val</span> <span class="py">randomIndex</span> <span class="p">=</span> <span class="p">(</span><span class="n">Math</span><span class="p">.</span><span class="n">random</span><span class="p">()</span> <span class="p">*</span> <span class="n">colorTable</span><span class="p">.</span><span class="n">size</span><span class="p">).</span><span class="n">toInt</span><span class="p">()</span>
</span><span class='line'>                    <span class="n">setBackgroundColor</span><span class="p">(</span><span class="n">Color</span><span class="p">.</span><span class="n">parseColor</span><span class="p">(</span><span class="n">colorTable</span><span class="p">[</span><span class="n">randomIndex</span><span class="p">]))</span>
</span><span class='line'>                    <span class="n">toast</span><span class="p">(</span><span class="s">&quot;Hello, ${name.text}! with color ${colorTable[randomIndex]}&quot;</span><span class="p">)</span>
</span><span class='line'>                <span class="p">}</span>
</span><span class='line'>            <span class="p">}</span>
</span><span class='line'>        <span class="p">}</span>
</span><span class='line'>    <span class="p">}</span>
</span><span class='line'><span class="p">}</span>
</span></code></pre></td></tr></table></div></figure>


<h2>实战，撸一个程序猿老黄历</h2>

<p>一个KotlinHello，还是过于toy，我们再来一个稍复杂点的小项目，以练手，考虑到Kotlin带来最大变化就是用Anko来写布局，所以我们弄个布局稍复杂的，所以，可以撸一个程序猿老黄历，它功能比较简单，主要就是布局，又不涉及网络，所以适合初学者练手。</p>

<h3>需求理解</h3>

<p>动手之前，先理解一下需求。我们要撸的是这个版本的<a href="http://sandbox.runjs.cn/show/ydp3it7b/">程序员老黄历</a>。
原理呢很简单，预定义一些事件，工具，饮品，方位等，然后用当前日期算出一个随机index，从预定义中取出一批，然后展示出来。其实呢，对于逻辑部分的代码，我们照抄就好，不用太关心。重点，是布局如何用Anko来实现。</p>

<h3>上手开撸</h3>

<ol>
<li>新建一个package: calendar</li>
</ol>


<p><img src="https://wx4.sinaimg.cn/mw690/870ad0baly1fs57e1j897j20wb0e0q6f.jpg" alt="create package calendar" /></p>

<ol>
<li>在calendar中新建一个empty activity: CalendarActivity</li>
</ol>


<p><img src="https://wx4.sinaimg.cn/mw690/870ad0baly1fs57e1g2rbj20mc0ix75e.jpg" alt="create calendar activity" /></p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
</pre></td><td class='code'><pre><code class='kotlin'><span class='line'><span class="k">class</span> <span class="nc">CalendarActivity</span> <span class="p">:</span> <span class="n">AppCompatActivity</span><span class="p">()</span> <span class="p">{</span>
</span><span class='line'>
</span><span class='line'>    <span class="k">override</span> <span class="k">fun</span> <span class="nf">onCreate</span><span class="p">(</span><span class="n">savedInstanceState</span><span class="p">:</span> <span class="n">Bundle</span><span class="p">?)</span> <span class="p">{</span>
</span><span class='line'>        <span class="k">super</span><span class="p">.</span><span class="n">onCreate</span><span class="p">(</span><span class="n">savedInstanceState</span><span class="p">)</span>
</span><span class='line'>        <span class="n">title</span> <span class="p">=</span> <span class="s">&quot;Programmer Calendar&quot;</span>
</span><span class='line'>    <span class="p">}</span>
</span><span class='line'><span class="p">}</span>
</span></code></pre></td></tr></table></div></figure>


<ol>
<li>点击KotlinHello中的button时，跳到CalendarActivity</li>
</ol>


<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
</pre></td><td class='code'><pre><code class='kotlin'><span class='line'><span class="n">onClick</span> <span class="p">{</span>
</span><span class='line'>    <span class="c1">// other codes</span>
</span><span class='line'>    <span class="n">startActivity</span><span class="p">&lt;</span><span class="n">CalendarActivity</span><span class="p">&gt;()</span>
</span><span class='line'><span class="p">}</span>
</span></code></pre></td></tr></table></div></figure>


<ol>
<li>开始撸布局
整体布局分五块：头部的日期，宜事抬头，宜事详细，坏事抬头，坏事详细，底部方向和指数。这其中，头部日期，可以用一个TextView来解决。宜和坏，是一样的，可以复用，宜（坏）事详细是一个列表，底部也是一个列表，但因为数目和每条内容是固定的，所以可以用三个View来解决。</li>
</ol>


<p>总结：</p>

<ol>
<li>根布局要是一个ScrollView，因为如果内容多时，或者屏幕太小时，可能会有超出屏幕的地方，所以根布局要能滑动。</li>
<li>中间好/坏， 以及好坏的具体事件，要用一个LinearLayout把两个包起来，因为好/坏的高度是由具体事件决定的，又要填充背景色，所以包上一层LinearLayout不可避免。</li>
<li>这样一来，从上到下，一个LinearLayout就可以了</li>
</ol>


<h3>运行效果</h3>

<p>最终运行效果：</p>

<p><img src="https://wx1.sinaimg.cn/mw690/870ad0baly1fs57e1i18vj20u01o0adk.jpg" height="720" width="360" alt="Final result of programmer calendar" /></p>

<h3>最终代码</h3>

<p>CalendarActivity，负责布局和展示</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
<span class='line-number'>25</span>
<span class='line-number'>26</span>
<span class='line-number'>27</span>
<span class='line-number'>28</span>
<span class='line-number'>29</span>
<span class='line-number'>30</span>
<span class='line-number'>31</span>
<span class='line-number'>32</span>
<span class='line-number'>33</span>
<span class='line-number'>34</span>
<span class='line-number'>35</span>
<span class='line-number'>36</span>
<span class='line-number'>37</span>
<span class='line-number'>38</span>
<span class='line-number'>39</span>
<span class='line-number'>40</span>
<span class='line-number'>41</span>
<span class='line-number'>42</span>
<span class='line-number'>43</span>
<span class='line-number'>44</span>
<span class='line-number'>45</span>
<span class='line-number'>46</span>
<span class='line-number'>47</span>
<span class='line-number'>48</span>
<span class='line-number'>49</span>
<span class='line-number'>50</span>
<span class='line-number'>51</span>
<span class='line-number'>52</span>
<span class='line-number'>53</span>
<span class='line-number'>54</span>
<span class='line-number'>55</span>
<span class='line-number'>56</span>
<span class='line-number'>57</span>
<span class='line-number'>58</span>
<span class='line-number'>59</span>
<span class='line-number'>60</span>
<span class='line-number'>61</span>
<span class='line-number'>62</span>
<span class='line-number'>63</span>
<span class='line-number'>64</span>
<span class='line-number'>65</span>
<span class='line-number'>66</span>
<span class='line-number'>67</span>
<span class='line-number'>68</span>
<span class='line-number'>69</span>
<span class='line-number'>70</span>
<span class='line-number'>71</span>
<span class='line-number'>72</span>
<span class='line-number'>73</span>
<span class='line-number'>74</span>
<span class='line-number'>75</span>
<span class='line-number'>76</span>
<span class='line-number'>77</span>
<span class='line-number'>78</span>
<span class='line-number'>79</span>
<span class='line-number'>80</span>
<span class='line-number'>81</span>
<span class='line-number'>82</span>
<span class='line-number'>83</span>
<span class='line-number'>84</span>
<span class='line-number'>85</span>
<span class='line-number'>86</span>
<span class='line-number'>87</span>
<span class='line-number'>88</span>
<span class='line-number'>89</span>
<span class='line-number'>90</span>
<span class='line-number'>91</span>
<span class='line-number'>92</span>
<span class='line-number'>93</span>
<span class='line-number'>94</span>
<span class='line-number'>95</span>
<span class='line-number'>96</span>
<span class='line-number'>97</span>
</pre></td><td class='code'><pre><code class='kotlin'><span class='line'><span class="k">class</span> <span class="nc">CalendarActivity</span> <span class="p">:</span> <span class="n">AppCompatActivity</span><span class="p">()</span> <span class="p">{</span>
</span><span class='line'>
</span><span class='line'>    <span class="k">override</span> <span class="k">fun</span> <span class="nf">onCreate</span><span class="p">(</span><span class="n">savedInstanceState</span><span class="p">:</span> <span class="n">Bundle</span><span class="p">?)</span> <span class="p">{</span>
</span><span class='line'>        <span class="k">super</span><span class="p">.</span><span class="n">onCreate</span><span class="p">(</span><span class="n">savedInstanceState</span><span class="p">)</span>
</span><span class='line'>        <span class="n">title</span> <span class="p">=</span> <span class="s">&quot;程序猿老黄历&quot;</span>
</span><span class='line'>
</span><span class='line'>        <span class="k">val</span> <span class="py">calendar</span> <span class="p">=</span> <span class="n">ProgrammerCalendar</span><span class="p">()</span>
</span><span class='line'>        <span class="n">scrollView</span> <span class="p">{</span>
</span><span class='line'>            <span class="n">verticalLayout</span> <span class="p">{</span>
</span><span class='line'>                <span class="k">val</span> <span class="py">dateString</span> <span class="p">=</span> <span class="n">buildSpanned</span> <span class="p">{</span>
</span><span class='line'>                    <span class="n">append</span><span class="p">(</span><span class="n">calendar</span><span class="p">.</span><span class="n">genTodayString</span><span class="p">(),</span> <span class="n">Bold</span><span class="p">)</span>
</span><span class='line'>                <span class="p">}</span>
</span><span class='line'>                <span class="k">val</span> <span class="py">dateLabel</span> <span class="p">=</span> <span class="n">textView</span><span class="p">(</span><span class="n">dateString</span><span class="p">)</span> <span class="p">{</span>
</span><span class='line'>                    <span class="n">id</span> <span class="p">=</span> <span class="n">View</span><span class="p">.</span><span class="n">generateViewId</span><span class="p">()</span>
</span><span class='line'>                    <span class="n">textColor</span> <span class="p">=</span> <span class="n">Color</span><span class="p">.</span><span class="n">BLACK</span>
</span><span class='line'>                    <span class="n">textSize</span> <span class="p">=</span> <span class="n">sp</span><span class="p">(</span><span class="m">6.4f</span><span class="p">).</span><span class="n">toFloat</span><span class="p">()</span>
</span><span class='line'>                    <span class="n">singleLine</span> <span class="p">=</span> <span class="k">true</span>
</span><span class='line'>                    <span class="n">textAlignment</span> <span class="p">=</span> <span class="n">View</span><span class="p">.</span><span class="n">TEXT_ALIGNMENT_CENTER</span>
</span><span class='line'>                <span class="p">}.</span><span class="n">lparams</span><span class="p">(</span><span class="n">width</span> <span class="p">=</span> <span class="n">matchParent</span><span class="p">,</span> <span class="n">height</span> <span class="p">=</span> <span class="n">wrapContent</span><span class="p">)</span> <span class="p">{</span>
</span><span class='line'>                    <span class="n">topMargin</span> <span class="p">=</span> <span class="n">dip</span><span class="p">(</span><span class="m">10</span><span class="p">)</span>
</span><span class='line'>                    <span class="n">bottomMargin</span> <span class="p">=</span> <span class="n">dip</span><span class="p">(</span><span class="m">10</span><span class="p">)</span>
</span><span class='line'>                <span class="p">}</span>
</span><span class='line'>
</span><span class='line'>                <span class="k">val</span> <span class="err">(</span><span class="py">goodList</span><span class="p">,</span> <span class="n">badList</span><span class="p">)</span> <span class="p">=</span> <span class="n">calendar</span><span class="p">.</span><span class="n">genTodayLuck</span><span class="p">()</span>
</span><span class='line'>                <span class="n">generateLuck</span><span class="p">(</span><span class="s">&quot;宜&quot;</span><span class="p">,</span> <span class="n">Color</span><span class="p">.</span><span class="n">parseColor</span><span class="p">(</span><span class="s">&quot;#ffee44&quot;</span><span class="p">),</span> <span class="n">Color</span><span class="p">.</span><span class="n">parseColor</span><span class="p">(</span><span class="s">&quot;#dddddd&quot;</span><span class="p">),</span> <span class="n">goodList</span><span class="p">)</span>
</span><span class='line'>
</span><span class='line'>                <span class="n">generateLuck</span><span class="p">(</span><span class="s">&quot;忌&quot;</span><span class="p">,</span> <span class="n">Color</span><span class="p">.</span><span class="n">parseColor</span><span class="p">(</span><span class="s">&quot;#ff4444&quot;</span><span class="p">),</span> <span class="n">Color</span><span class="p">.</span><span class="n">parseColor</span><span class="p">(</span><span class="s">&quot;#aaaaaa&quot;</span><span class="p">),</span> <span class="n">badList</span><span class="p">)</span>
</span><span class='line'>
</span><span class='line'>                <span class="c1">// Direction</span>
</span><span class='line'>                <span class="k">val</span> <span class="py">directionDetail</span> <span class="p">=</span> <span class="n">buildSpanned</span> <span class="p">{</span>
</span><span class='line'>                    <span class="n">append</span><span class="p">(</span><span class="s">&quot;座位朝向：&quot;</span><span class="p">,</span> <span class="n">Bold</span><span class="p">)</span>
</span><span class='line'>                    <span class="n">append</span><span class="p">(</span><span class="s">&quot;面向&quot;</span><span class="p">)</span>
</span><span class='line'>                    <span class="n">append</span><span class="p">(</span><span class="n">calendar</span><span class="p">.</span><span class="n">genDirection</span><span class="p">(),</span> <span class="n">foregroundColor</span><span class="p">(</span><span class="n">Color</span><span class="p">.</span><span class="n">GREEN</span><span class="p">))</span>
</span><span class='line'>                    <span class="n">append</span><span class="p">(</span><span class="s">&quot;写程序，BUG最少。&quot;</span><span class="p">)</span>
</span><span class='line'>                <span class="p">}</span>
</span><span class='line'>                <span class="k">val</span> <span class="py">direction</span> <span class="p">=</span> <span class="n">extraLabel</span><span class="p">(</span><span class="n">directionDetail</span><span class="p">)</span>
</span><span class='line'>
</span><span class='line'>                <span class="c1">// Drink</span>
</span><span class='line'>                <span class="k">val</span> <span class="py">drinkDetail</span> <span class="p">=</span> <span class="n">buildSpanned</span> <span class="p">{</span>
</span><span class='line'>                    <span class="n">append</span><span class="p">(</span><span class="s">&quot;今日饮品：&quot;</span><span class="p">,</span> <span class="n">Bold</span><span class="p">)</span>
</span><span class='line'>                    <span class="n">append</span><span class="p">(</span><span class="n">calendar</span><span class="p">.</span><span class="n">genDrinks</span><span class="p">())</span>
</span><span class='line'>                <span class="p">}</span>
</span><span class='line'>                <span class="k">val</span> <span class="py">drink</span> <span class="p">=</span> <span class="n">extraLabel</span><span class="p">(</span><span class="n">drinkDetail</span><span class="p">)</span>
</span><span class='line'>
</span><span class='line'>                <span class="k">val</span> <span class="py">girlDetail</span> <span class="p">=</span> <span class="n">buildSpanned</span> <span class="p">{</span>
</span><span class='line'>                    <span class="n">append</span><span class="p">(</span><span class="s">&quot;女神亲近指数：&quot;</span><span class="p">,</span> <span class="n">Bold</span><span class="p">)</span>
</span><span class='line'>                    <span class="n">append</span><span class="p">(</span><span class="n">calendar</span><span class="p">.</span><span class="n">genGirlsIndex</span><span class="p">())</span>
</span><span class='line'>                <span class="p">}</span>
</span><span class='line'>                <span class="k">val</span> <span class="py">girl</span> <span class="p">=</span> <span class="n">extraLabel</span><span class="p">(</span><span class="n">girlDetail</span><span class="p">)</span>
</span><span class='line'>            <span class="p">}</span>
</span><span class='line'>        <span class="p">}</span>
</span><span class='line'>    <span class="p">}</span>
</span><span class='line'>
</span><span class='line'>    <span class="k">private</span> <span class="k">fun</span> <span class="nf">@AnkoViewDslMarker</span> <span class="n">_LinearLayout</span><span class="p">.</span><span class="n">extraLabel</span><span class="p">(</span><span class="n">detail</span><span class="p">:</span> <span class="n">CharSequence</span><span class="p">):</span> <span class="n">TextView</span> <span class="p">{</span>
</span><span class='line'>        <span class="k">return</span> <span class="n">textView</span><span class="p">(</span><span class="n">detail</span><span class="p">)</span> <span class="p">{</span>
</span><span class='line'>            <span class="n">textSize</span> <span class="p">=</span> <span class="n">sp</span><span class="p">(</span><span class="m">5</span><span class="p">).</span><span class="n">toFloat</span><span class="p">()</span>
</span><span class='line'>            <span class="n">horizontalPadding</span> <span class="p">=</span> <span class="n">dip</span><span class="p">(</span><span class="m">10</span><span class="p">)</span>
</span><span class='line'>            <span class="n">verticalPadding</span> <span class="p">=</span> <span class="n">dip</span><span class="p">(</span><span class="m">6</span><span class="p">)</span>
</span><span class='line'>        <span class="p">}</span>
</span><span class='line'>    <span class="p">}</span>
</span><span class='line'>
</span><span class='line'>    <span class="k">private</span> <span class="k">fun</span> <span class="nf">@AnkoViewDslMarker</span> <span class="n">_LinearLayout</span><span class="p">.</span><span class="n">generateLuck</span><span class="p">(</span><span class="k">type</span><span class="p">:</span> <span class="n">String</span><span class="p">,</span>
</span><span class='line'>                                                              <span class="n">typeColor</span><span class="p">:</span> <span class="n">Int</span><span class="p">,</span>
</span><span class='line'>                                                              <span class="n">detailColor</span><span class="p">:</span> <span class="n">Int</span><span class="p">,</span>
</span><span class='line'>                                                              <span class="n">eventList</span><span class="p">:</span> <span class="n">List</span><span class="p">&lt;</span><span class="n">Map</span><span class="p">&lt;</span><span class="n">String</span><span class="p">,</span> <span class="n">String</span><span class="p">&gt;&gt;)</span> <span class="p">{</span>
</span><span class='line'>        <span class="n">linearLayout</span> <span class="p">{</span>
</span><span class='line'>            <span class="n">orientation</span> <span class="p">=</span> <span class="n">LinearLayout</span><span class="p">.</span><span class="n">HORIZONTAL</span>
</span><span class='line'>
</span><span class='line'>            <span class="k">val</span> <span class="py">good</span> <span class="p">=</span> <span class="n">textView</span><span class="p">(</span><span class="k">type</span><span class="p">)</span> <span class="p">{</span>
</span><span class='line'>                <span class="n">id</span> <span class="p">=</span> <span class="n">View</span><span class="p">.</span><span class="n">generateViewId</span><span class="p">()</span>
</span><span class='line'>                <span class="n">textColor</span> <span class="p">=</span> <span class="n">Color</span><span class="p">.</span><span class="n">WHITE</span>
</span><span class='line'>                <span class="n">textSize</span> <span class="p">=</span> <span class="n">sp</span><span class="p">(</span><span class="m">14</span><span class="p">).</span><span class="n">toFloat</span><span class="p">()</span>
</span><span class='line'>                <span class="n">textAlignment</span> <span class="p">=</span> <span class="n">View</span><span class="p">.</span><span class="n">TEXT_ALIGNMENT_CENTER</span>
</span><span class='line'>                <span class="n">gravity</span> <span class="p">=</span> <span class="n">Gravity</span><span class="p">.</span><span class="n">CENTER</span>
</span><span class='line'>                <span class="n">backgroundColor</span> <span class="p">=</span> <span class="n">typeColor</span>
</span><span class='line'>            <span class="p">}.</span><span class="n">lparams</span><span class="p">(</span><span class="n">width</span> <span class="p">=</span> <span class="n">dip</span><span class="p">(</span><span class="m">100</span><span class="p">),</span> <span class="n">height</span> <span class="p">=</span> <span class="n">matchParent</span><span class="p">)</span>
</span><span class='line'>
</span><span class='line'>            <span class="k">val</span> <span class="py">goodDetail</span> <span class="p">=</span> <span class="n">verticalLayout</span> <span class="p">{</span>
</span><span class='line'>                <span class="n">id</span> <span class="p">=</span> <span class="n">View</span><span class="p">.</span><span class="n">generateViewId</span><span class="p">()</span>
</span><span class='line'>                <span class="n">eventList</span><span class="p">.</span><span class="n">forEach</span> <span class="p">{</span>
</span><span class='line'>                    <span class="k">val</span> <span class="py">caption</span> <span class="p">=</span> <span class="n">textView</span><span class="p">(</span><span class="n">it</span><span class="p">[</span><span class="n">ProgrammerCalendar</span><span class="p">.</span><span class="n">NAME</span><span class="p">])</span> <span class="p">{</span>
</span><span class='line'>                        <span class="n">textColor</span> <span class="p">=</span> <span class="n">Color</span><span class="p">.</span><span class="n">BLACK</span>
</span><span class='line'>                        <span class="n">textSize</span> <span class="p">=</span> <span class="n">sp</span><span class="p">(</span><span class="m">6</span><span class="p">).</span><span class="n">toFloat</span><span class="p">()</span>
</span><span class='line'>                    <span class="p">}</span>
</span><span class='line'>                    <span class="k">val</span> <span class="py">detail</span> <span class="p">=</span> <span class="n">textView</span><span class="p">(</span><span class="n">it</span><span class="p">[</span><span class="n">ProgrammerCalendar</span><span class="p">.</span><span class="n">DESCRIPTION</span><span class="p">])</span> <span class="p">{</span>
</span><span class='line'>                        <span class="n">textColor</span> <span class="p">=</span> <span class="n">Color</span><span class="p">.</span><span class="n">GRAY</span>
</span><span class='line'>                        <span class="n">textSize</span> <span class="p">=</span> <span class="n">sp</span><span class="p">(</span><span class="m">5</span><span class="p">).</span><span class="n">toFloat</span><span class="p">()</span>
</span><span class='line'>                        <span class="n">horizontalPadding</span> <span class="p">=</span> <span class="n">dip</span><span class="p">(</span><span class="m">2</span><span class="p">)</span>
</span><span class='line'>                    <span class="p">}</span>
</span><span class='line'>                <span class="p">}</span>
</span><span class='line'>                <span class="n">horizontalPadding</span> <span class="p">=</span> <span class="n">dip</span><span class="p">(</span><span class="m">15</span><span class="p">)</span>
</span><span class='line'>                <span class="n">backgroundColor</span> <span class="p">=</span> <span class="n">detailColor</span>
</span><span class='line'>                <span class="n">verticalPadding</span> <span class="p">=</span> <span class="n">dip</span><span class="p">(</span><span class="m">10</span><span class="p">)</span>
</span><span class='line'>            <span class="p">}.</span><span class="n">lparams</span><span class="p">(</span><span class="n">width</span> <span class="p">=</span> <span class="n">matchParent</span><span class="p">,</span> <span class="n">height</span> <span class="p">=</span> <span class="n">wrapContent</span><span class="p">)</span>
</span><span class='line'>        <span class="p">}</span>
</span><span class='line'>    <span class="p">}</span>
</span><span class='line'><span class="p">}</span>
</span></code></pre></td></tr></table></div></figure>


<p>ProgrammerCalendar，这里是业务逻辑</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
<span class='line-number'>25</span>
<span class='line-number'>26</span>
<span class='line-number'>27</span>
<span class='line-number'>28</span>
<span class='line-number'>29</span>
<span class='line-number'>30</span>
<span class='line-number'>31</span>
<span class='line-number'>32</span>
<span class='line-number'>33</span>
<span class='line-number'>34</span>
<span class='line-number'>35</span>
<span class='line-number'>36</span>
<span class='line-number'>37</span>
<span class='line-number'>38</span>
<span class='line-number'>39</span>
<span class='line-number'>40</span>
<span class='line-number'>41</span>
<span class='line-number'>42</span>
<span class='line-number'>43</span>
<span class='line-number'>44</span>
<span class='line-number'>45</span>
<span class='line-number'>46</span>
<span class='line-number'>47</span>
<span class='line-number'>48</span>
<span class='line-number'>49</span>
<span class='line-number'>50</span>
<span class='line-number'>51</span>
<span class='line-number'>52</span>
<span class='line-number'>53</span>
<span class='line-number'>54</span>
<span class='line-number'>55</span>
<span class='line-number'>56</span>
<span class='line-number'>57</span>
<span class='line-number'>58</span>
<span class='line-number'>59</span>
<span class='line-number'>60</span>
<span class='line-number'>61</span>
<span class='line-number'>62</span>
<span class='line-number'>63</span>
<span class='line-number'>64</span>
<span class='line-number'>65</span>
<span class='line-number'>66</span>
<span class='line-number'>67</span>
<span class='line-number'>68</span>
<span class='line-number'>69</span>
<span class='line-number'>70</span>
<span class='line-number'>71</span>
<span class='line-number'>72</span>
<span class='line-number'>73</span>
<span class='line-number'>74</span>
<span class='line-number'>75</span>
<span class='line-number'>76</span>
<span class='line-number'>77</span>
<span class='line-number'>78</span>
<span class='line-number'>79</span>
<span class='line-number'>80</span>
<span class='line-number'>81</span>
<span class='line-number'>82</span>
<span class='line-number'>83</span>
<span class='line-number'>84</span>
<span class='line-number'>85</span>
<span class='line-number'>86</span>
<span class='line-number'>87</span>
<span class='line-number'>88</span>
<span class='line-number'>89</span>
<span class='line-number'>90</span>
<span class='line-number'>91</span>
<span class='line-number'>92</span>
<span class='line-number'>93</span>
<span class='line-number'>94</span>
<span class='line-number'>95</span>
<span class='line-number'>96</span>
<span class='line-number'>97</span>
<span class='line-number'>98</span>
<span class='line-number'>99</span>
<span class='line-number'>100</span>
<span class='line-number'>101</span>
<span class='line-number'>102</span>
<span class='line-number'>103</span>
<span class='line-number'>104</span>
<span class='line-number'>105</span>
<span class='line-number'>106</span>
<span class='line-number'>107</span>
<span class='line-number'>108</span>
<span class='line-number'>109</span>
<span class='line-number'>110</span>
<span class='line-number'>111</span>
<span class='line-number'>112</span>
<span class='line-number'>113</span>
<span class='line-number'>114</span>
<span class='line-number'>115</span>
<span class='line-number'>116</span>
<span class='line-number'>117</span>
<span class='line-number'>118</span>
<span class='line-number'>119</span>
<span class='line-number'>120</span>
<span class='line-number'>121</span>
<span class='line-number'>122</span>
<span class='line-number'>123</span>
<span class='line-number'>124</span>
<span class='line-number'>125</span>
<span class='line-number'>126</span>
<span class='line-number'>127</span>
<span class='line-number'>128</span>
<span class='line-number'>129</span>
<span class='line-number'>130</span>
<span class='line-number'>131</span>
<span class='line-number'>132</span>
<span class='line-number'>133</span>
<span class='line-number'>134</span>
<span class='line-number'>135</span>
<span class='line-number'>136</span>
<span class='line-number'>137</span>
<span class='line-number'>138</span>
<span class='line-number'>139</span>
<span class='line-number'>140</span>
<span class='line-number'>141</span>
<span class='line-number'>142</span>
<span class='line-number'>143</span>
<span class='line-number'>144</span>
<span class='line-number'>145</span>
<span class='line-number'>146</span>
<span class='line-number'>147</span>
<span class='line-number'>148</span>
<span class='line-number'>149</span>
<span class='line-number'>150</span>
<span class='line-number'>151</span>
<span class='line-number'>152</span>
<span class='line-number'>153</span>
<span class='line-number'>154</span>
<span class='line-number'>155</span>
<span class='line-number'>156</span>
<span class='line-number'>157</span>
<span class='line-number'>158</span>
<span class='line-number'>159</span>
<span class='line-number'>160</span>
<span class='line-number'>161</span>
<span class='line-number'>162</span>
<span class='line-number'>163</span>
<span class='line-number'>164</span>
<span class='line-number'>165</span>
<span class='line-number'>166</span>
<span class='line-number'>167</span>
<span class='line-number'>168</span>
<span class='line-number'>169</span>
<span class='line-number'>170</span>
<span class='line-number'>171</span>
<span class='line-number'>172</span>
<span class='line-number'>173</span>
<span class='line-number'>174</span>
<span class='line-number'>175</span>
<span class='line-number'>176</span>
<span class='line-number'>177</span>
<span class='line-number'>178</span>
<span class='line-number'>179</span>
<span class='line-number'>180</span>
<span class='line-number'>181</span>
<span class='line-number'>182</span>
<span class='line-number'>183</span>
<span class='line-number'>184</span>
</pre></td><td class='code'><pre><code class='kotlin'><span class='line'><span class="k">class</span> <span class="nc">ProgrammerCalendar</span> <span class="p">{</span>
</span><span class='line'>    <span class="n">companion</span> <span class="k">object</span> <span class="nc">EventKey</span> <span class="p">{</span>
</span><span class='line'>        <span class="n">const</span> <span class="k">val</span> <span class="py">NAME</span> <span class="p">=</span> <span class="s">&quot;name&quot;</span>
</span><span class='line'>        <span class="n">const</span> <span class="k">val</span> <span class="py">GOOD</span> <span class="p">=</span> <span class="s">&quot;good&quot;</span>
</span><span class='line'>        <span class="n">const</span> <span class="k">val</span> <span class="py">BAD</span> <span class="p">=</span> <span class="s">&quot;bad&quot;</span>
</span><span class='line'>        <span class="n">const</span> <span class="k">val</span> <span class="py">WEEKEND</span> <span class="p">=</span> <span class="s">&quot;weekend&quot;</span>
</span><span class='line'>        <span class="n">const</span> <span class="k">val</span> <span class="py">DATE</span> <span class="p">=</span> <span class="s">&quot;date&quot;</span>
</span><span class='line'>        <span class="n">const</span> <span class="k">val</span> <span class="py">TYPE</span> <span class="p">=</span> <span class="s">&quot;type&quot;</span>
</span><span class='line'>        <span class="n">const</span> <span class="k">val</span> <span class="py">DESCRIPTION</span> <span class="p">=</span> <span class="s">&quot;description&quot;</span>
</span><span class='line'>    <span class="p">}</span>
</span><span class='line'>
</span><span class='line'>    <span class="k">private</span> <span class="k">val</span> <span class="py">weeks</span> <span class="p">=</span> <span class="n">listOf</span><span class="p">(</span> <span class="s">&quot;日&quot;</span><span class="p">,</span> <span class="s">&quot;一&quot;</span><span class="p">,</span> <span class="s">&quot;二&quot;</span><span class="p">,</span> <span class="s">&quot;三&quot;</span><span class="p">,</span> <span class="s">&quot;四&quot;</span><span class="p">,</span> <span class="s">&quot;五&quot;</span><span class="p">,</span> <span class="s">&quot;六&quot;</span><span class="p">)</span>
</span><span class='line'>    <span class="k">private</span> <span class="k">val</span> <span class="py">directions</span> <span class="p">=</span> <span class="n">listOf</span><span class="p">(</span><span class="s">&quot;北方&quot;</span><span class="p">,</span> <span class="s">&quot;东北方&quot;</span><span class="p">,</span> <span class="s">&quot;东方&quot;</span><span class="p">,</span> <span class="s">&quot;东南方&quot;</span><span class="p">,</span> <span class="s">&quot;南方&quot;</span><span class="p">,</span> <span class="s">&quot;西南方&quot;</span><span class="p">,</span> <span class="s">&quot;西方&quot;</span><span class="p">,</span> <span class="s">&quot;西北方&quot;</span><span class="p">)</span>
</span><span class='line'>    <span class="k">private</span> <span class="k">val</span> <span class="py">activities</span> <span class="p">=</span> <span class="n">listOf</span><span class="p">(</span>
</span><span class='line'>            <span class="n">mapOf</span><span class="p">(</span><span class="n">NAME</span> <span class="n">to</span> <span class="s">&quot;写单元测试&quot;</span><span class="p">,</span> <span class="n">GOOD</span> <span class="n">to</span> <span class="s">&quot;写单元测试将减少出错&quot;</span><span class="p">,</span> <span class="n">BAD</span> <span class="n">to</span> <span class="s">&quot;写单元测试会降低你的开发效率&quot;</span><span class="p">),</span>
</span><span class='line'>            <span class="n">mapOf</span><span class="p">(</span><span class="n">NAME</span> <span class="n">to</span> <span class="s">&quot;洗澡&quot;</span><span class="p">,</span> <span class="n">GOOD</span> <span class="n">to</span> <span class="s">&quot;你几天没洗澡了？&quot;</span><span class="p">,</span> <span class="n">BAD</span> <span class="n">to</span> <span class="s">&quot;会把设计方面的灵感洗掉&quot;</span><span class="p">,</span> <span class="n">WEEKEND</span> <span class="n">to</span> <span class="s">&quot;true&quot;</span><span class="p">),</span>
</span><span class='line'>            <span class="n">mapOf</span><span class="p">(</span><span class="n">NAME</span> <span class="n">to</span> <span class="s">&quot;锻炼一下身体&quot;</span><span class="p">,</span> <span class="n">GOOD</span> <span class="n">to</span> <span class="s">&quot;&quot;</span><span class="p">,</span> <span class="n">BAD</span> <span class="n">to</span> <span class="s">&quot;能量没消耗多少，吃得却更多&quot;</span><span class="p">,</span> <span class="n">WEEKEND</span> <span class="n">to</span> <span class="s">&quot;true&quot;</span><span class="p">),</span>
</span><span class='line'>            <span class="n">mapOf</span><span class="p">(</span><span class="n">NAME</span> <span class="n">to</span> <span class="s">&quot;抽烟&quot;</span><span class="p">,</span> <span class="n">GOOD</span> <span class="n">to</span> <span class="s">&quot;抽烟有利于提神，增加思维敏捷&quot;</span><span class="p">,</span> <span class="n">BAD</span> <span class="n">to</span> <span class="s">&quot;除非你活够了，死得早点没关系&quot;</span><span class="p">,</span> <span class="n">WEEKEND</span> <span class="n">to</span> <span class="s">&quot;true&quot;</span><span class="p">),</span>
</span><span class='line'>            <span class="n">mapOf</span><span class="p">(</span><span class="n">NAME</span> <span class="n">to</span> <span class="s">&quot;白天上线&quot;</span><span class="p">,</span> <span class="n">GOOD</span> <span class="n">to</span> <span class="s">&quot;今天白天上线是安全的&quot;</span><span class="p">,</span> <span class="n">BAD</span> <span class="n">to</span> <span class="s">&quot;可能导致灾难性后果&quot;</span><span class="p">),</span>
</span><span class='line'>            <span class="n">mapOf</span><span class="p">(</span><span class="n">NAME</span> <span class="n">to</span> <span class="s">&quot;重构&quot;</span><span class="p">,</span> <span class="n">GOOD</span> <span class="n">to</span> <span class="s">&quot;代码质量得到提高&quot;</span><span class="p">,</span> <span class="n">BAD</span> <span class="n">to</span> <span class="s">&quot;你很有可能会陷入泥潭&quot;</span><span class="p">),</span>
</span><span class='line'>            <span class="n">mapOf</span><span class="p">(</span><span class="n">NAME</span> <span class="n">to</span> <span class="s">&quot;使用%t&quot;</span><span class="p">,</span> <span class="n">GOOD</span> <span class="n">to</span> <span class="s">&quot;你看起来更有品位&quot;</span><span class="p">,</span> <span class="n">BAD</span> <span class="n">to</span> <span class="s">&quot;别人会觉得你在装逼&quot;</span><span class="p">),</span>
</span><span class='line'>            <span class="n">mapOf</span><span class="p">(</span><span class="n">NAME</span> <span class="n">to</span> <span class="s">&quot;跳槽&quot;</span><span class="p">,</span> <span class="n">GOOD</span> <span class="n">to</span> <span class="s">&quot;该放手时就放手&quot;</span><span class="p">,</span> <span class="n">BAD</span> <span class="n">to</span> <span class="s">&quot;鉴于当前的经济形势，你的下一份工作未必比现在强&quot;</span><span class="p">),</span>
</span><span class='line'>            <span class="n">mapOf</span><span class="p">(</span><span class="n">NAME</span> <span class="n">to</span> <span class="s">&quot;招人&quot;</span><span class="p">,</span> <span class="n">GOOD</span> <span class="n">to</span> <span class="s">&quot;你面前这位有成为牛人的潜质&quot;</span><span class="p">,</span> <span class="n">BAD</span> <span class="n">to</span> <span class="s">&quot;这人会写程序吗？&quot;</span><span class="p">),</span>
</span><span class='line'>            <span class="n">mapOf</span><span class="p">(</span><span class="n">NAME</span> <span class="n">to</span> <span class="s">&quot;面试&quot;</span><span class="p">,</span> <span class="n">GOOD</span> <span class="n">to</span> <span class="s">&quot;面试官今天心情Xiao很好&quot;</span><span class="p">,</span> <span class="n">BAD</span> <span class="n">to</span> <span class="s">&quot;面试官不爽，会拿你出气&quot;</span><span class="p">),</span>
</span><span class='line'>            <span class="n">mapOf</span><span class="p">(</span><span class="n">NAME</span> <span class="n">to</span> <span class="s">&quot;提交辞职申请&quot;</span><span class="p">,</span> <span class="n">GOOD</span> <span class="n">to</span> <span class="s">&quot;公司找到了一个比你更能干更便宜的家伙，巴不得你赶快滚蛋&quot;</span><span class="p">,</span> <span class="n">BAD</span> <span class="n">to</span> <span class="s">&quot;鉴于当前的经济形势，你的下一份工作未必比现在强&quot;</span><span class="p">),</span>
</span><span class='line'>            <span class="n">mapOf</span><span class="p">(</span><span class="n">NAME</span> <span class="n">to</span> <span class="s">&quot;申请加薪&quot;</span><span class="p">,</span> <span class="n">GOOD</span> <span class="n">to</span> <span class="s">&quot;老板今天心情很好&quot;</span><span class="p">,</span> <span class="n">BAD</span> <span class="n">to</span> <span class="s">&quot;公司正在考虑裁员&quot;</span><span class="p">),</span>
</span><span class='line'>            <span class="n">mapOf</span><span class="p">(</span><span class="n">NAME</span> <span class="n">to</span> <span class="s">&quot;晚上加班&quot;</span><span class="p">,</span> <span class="n">GOOD</span> <span class="n">to</span> <span class="s">&quot;晚上是程序员精神最好的时候&quot;</span><span class="p">,</span> <span class="n">BAD</span> <span class="n">to</span> <span class="s">&quot;&quot;</span><span class="p">,</span> <span class="n">WEEKEND</span> <span class="n">to</span> <span class="s">&quot;true&quot;</span><span class="p">),</span>
</span><span class='line'>            <span class="n">mapOf</span><span class="p">(</span><span class="n">NAME</span> <span class="n">to</span> <span class="s">&quot;在妹子面前吹牛&quot;</span><span class="p">,</span> <span class="n">GOOD</span> <span class="n">to</span> <span class="s">&quot;改善你矮穷挫的形象&quot;</span><span class="p">,</span> <span class="n">BAD</span> <span class="n">to</span> <span class="s">&quot;会被识破&quot;</span><span class="p">,</span> <span class="n">WEEKEND</span> <span class="n">to</span> <span class="s">&quot;true&quot;</span><span class="p">),</span>
</span><span class='line'>            <span class="n">mapOf</span><span class="p">(</span><span class="n">NAME</span> <span class="n">to</span> <span class="s">&quot;撸管&quot;</span><span class="p">,</span> <span class="n">GOOD</span> <span class="n">to</span> <span class="s">&quot;避免缓冲区溢出&quot;</span><span class="p">,</span> <span class="n">BAD</span> <span class="n">to</span> <span class="s">&quot;强撸灰飞烟灭&quot;</span><span class="p">,</span> <span class="n">WEEKEND</span> <span class="n">to</span> <span class="s">&quot;true&quot;</span><span class="p">),</span>
</span><span class='line'>            <span class="n">mapOf</span><span class="p">(</span><span class="n">NAME</span> <span class="n">to</span> <span class="s">&quot;浏览成人网站&quot;</span><span class="p">,</span> <span class="n">GOOD</span> <span class="n">to</span> <span class="s">&quot;重拾对生活的信心&quot;</span><span class="p">,</span> <span class="n">BAD</span> <span class="n">to</span> <span class="s">&quot;你会心神不宁&quot;</span><span class="p">,</span> <span class="n">WEEKEND</span> <span class="n">to</span> <span class="s">&quot;true&quot;</span><span class="p">),</span>
</span><span class='line'>            <span class="n">mapOf</span><span class="p">(</span><span class="n">NAME</span> <span class="n">to</span> <span class="s">&quot;命名变量\&quot;%v\&quot;&quot;</span><span class="p">,</span> <span class="n">GOOD</span> <span class="n">to</span> <span class="s">&quot;&quot;</span><span class="p">,</span> <span class="n">BAD</span> <span class="n">to</span> <span class="s">&quot;&quot;</span><span class="p">),</span>
</span><span class='line'>            <span class="n">mapOf</span><span class="p">(</span><span class="n">NAME</span> <span class="n">to</span> <span class="s">&quot;写超过%l行的方法&quot;</span><span class="p">,</span> <span class="n">GOOD</span> <span class="n">to</span> <span class="s">&quot;你的代码组织的很好，长一点没关系&quot;</span><span class="p">,</span> <span class="n">BAD</span> <span class="n">to</span> <span class="s">&quot;你的代码将混乱不堪，你自己都看不懂&quot;</span><span class="p">),</span>
</span><span class='line'>            <span class="n">mapOf</span><span class="p">(</span><span class="n">NAME</span> <span class="n">to</span> <span class="s">&quot;提交代码&quot;</span><span class="p">,</span> <span class="n">GOOD</span> <span class="n">to</span> <span class="s">&quot;遇到冲突的几率是最低的&quot;</span><span class="p">,</span> <span class="n">BAD</span> <span class="n">to</span> <span class="s">&quot;你遇到的一大堆冲突会让你觉得自己是不是时间穿越了&quot;</span><span class="p">),</span>
</span><span class='line'>            <span class="n">mapOf</span><span class="p">(</span><span class="n">NAME</span> <span class="n">to</span> <span class="s">&quot;代码复审&quot;</span><span class="p">,</span> <span class="n">GOOD</span> <span class="n">to</span> <span class="s">&quot;发现重要问题的几率大大增加&quot;</span><span class="p">,</span> <span class="n">BAD</span> <span class="n">to</span> <span class="s">&quot;你什么问题都发现不了，白白浪费时间&quot;</span><span class="p">),</span>
</span><span class='line'>            <span class="n">mapOf</span><span class="p">(</span><span class="n">NAME</span> <span class="n">to</span> <span class="s">&quot;开会&quot;</span><span class="p">,</span> <span class="n">GOOD</span> <span class="n">to</span> <span class="s">&quot;写代码之余放松一下打个盹，有益健康&quot;</span><span class="p">,</span> <span class="n">BAD</span> <span class="n">to</span> <span class="s">&quot;小心被扣屎盆子背黑锅&quot;</span><span class="p">),</span>
</span><span class='line'>            <span class="n">mapOf</span><span class="p">(</span><span class="n">NAME</span> <span class="n">to</span> <span class="s">&quot;打DOTA&quot;</span><span class="p">,</span> <span class="n">GOOD</span> <span class="n">to</span> <span class="s">&quot;你将有如神助&quot;</span><span class="p">,</span> <span class="n">BAD</span> <span class="n">to</span> <span class="s">&quot;你会被虐的很惨&quot;</span><span class="p">,</span> <span class="n">WEEKEND</span> <span class="n">to</span> <span class="s">&quot;true&quot;</span><span class="p">),</span>
</span><span class='line'>            <span class="n">mapOf</span><span class="p">(</span><span class="n">NAME</span> <span class="n">to</span> <span class="s">&quot;晚上上线&quot;</span><span class="p">,</span> <span class="n">GOOD</span> <span class="n">to</span> <span class="s">&quot;晚上是程序员精神最好的时候&quot;</span><span class="p">,</span> <span class="n">BAD</span> <span class="n">to</span> <span class="s">&quot;你白天已经筋疲力尽了&quot;</span><span class="p">),</span>
</span><span class='line'>            <span class="n">mapOf</span><span class="p">(</span><span class="n">NAME</span> <span class="n">to</span> <span class="s">&quot;修复BUG&quot;</span><span class="p">,</span> <span class="n">GOOD</span> <span class="n">to</span> <span class="s">&quot;你今天对BUG的嗅觉大大提高&quot;</span><span class="p">,</span> <span class="n">BAD</span> <span class="n">to</span> <span class="s">&quot;新产生的BUG将比修复的更多&quot;</span><span class="p">),</span>
</span><span class='line'>            <span class="n">mapOf</span><span class="p">(</span><span class="n">NAME</span> <span class="n">to</span> <span class="s">&quot;设计评审&quot;</span><span class="p">,</span> <span class="n">GOOD</span> <span class="n">to</span> <span class="s">&quot;设计评审会议将变成头脑风暴&quot;</span><span class="p">,</span> <span class="n">BAD</span> <span class="n">to</span> <span class="s">&quot;人人筋疲力尽，评审就这么过了&quot;</span><span class="p">),</span>
</span><span class='line'>            <span class="n">mapOf</span><span class="p">(</span><span class="n">NAME</span> <span class="n">to</span> <span class="s">&quot;需求评审&quot;</span><span class="p">,</span> <span class="n">GOOD</span> <span class="n">to</span> <span class="s">&quot;&quot;</span><span class="p">,</span> <span class="n">BAD</span> <span class="n">to</span> <span class="s">&quot;&quot;</span><span class="p">),</span>
</span><span class='line'>            <span class="n">mapOf</span><span class="p">(</span><span class="n">NAME</span> <span class="n">to</span> <span class="s">&quot;上微博&quot;</span><span class="p">,</span> <span class="n">GOOD</span> <span class="n">to</span> <span class="s">&quot;今天发生的事不能错过&quot;</span><span class="p">,</span> <span class="n">BAD</span> <span class="n">to</span> <span class="s">&quot;今天的微博充满负能量&quot;</span><span class="p">,</span> <span class="n">WEEKEND</span> <span class="n">to</span> <span class="s">&quot;true&quot;</span><span class="p">),</span>
</span><span class='line'>            <span class="n">mapOf</span><span class="p">(</span><span class="n">NAME</span> <span class="n">to</span> <span class="s">&quot;上AB站&quot;</span><span class="p">,</span> <span class="n">GOOD</span> <span class="n">to</span> <span class="s">&quot;还需要理由吗？&quot;</span><span class="p">,</span> <span class="n">BAD</span> <span class="n">to</span> <span class="s">&quot;满屏兄贵亮瞎你的眼&quot;</span><span class="p">,</span> <span class="n">WEEKEND</span> <span class="n">to</span> <span class="s">&quot;true&quot;</span><span class="p">),</span>
</span><span class='line'>            <span class="n">mapOf</span><span class="p">(</span><span class="n">NAME</span> <span class="n">to</span> <span class="s">&quot;玩FlappyBird&quot;</span><span class="p">,</span> <span class="n">GOOD</span> <span class="n">to</span> <span class="s">&quot;今天破纪录的几率很高&quot;</span><span class="p">,</span> <span class="n">BAD</span> <span class="n">to</span> <span class="s">&quot;除非你想玩到把手机砸了&quot;</span><span class="p">,</span> <span class="n">WEEKEND</span> <span class="n">to</span> <span class="s">&quot;true&quot;</span><span class="p">)</span>
</span><span class='line'>    <span class="p">)</span>
</span><span class='line'>
</span><span class='line'>
</span><span class='line'>    <span class="k">private</span> <span class="k">val</span> <span class="py">specials</span> <span class="p">=</span> <span class="n">listOf</span><span class="p">(</span>
</span><span class='line'>            <span class="n">mapOf</span><span class="p">(</span><span class="n">DATE</span> <span class="n">to</span> <span class="s">&quot;20140214&quot;</span><span class="p">,</span> <span class="n">TYPE</span> <span class="n">to</span> <span class="s">&quot;BAD&quot;</span><span class="p">,</span> <span class="n">NAME</span> <span class="n">to</span> <span class="s">&quot;待在男（女）友身边&quot;</span><span class="p">,</span> <span class="n">DESCRIPTION</span> <span class="n">to</span> <span class="s">&quot;脱团火葬场，入团保平安。&quot;</span><span class="p">)</span>
</span><span class='line'>    <span class="p">)</span>
</span><span class='line'>
</span><span class='line'>    <span class="k">private</span> <span class="k">val</span> <span class="py">tools</span> <span class="p">=</span> <span class="n">listOf</span><span class="p">(</span><span class="s">&quot;Eclipse写程序&quot;</span><span class="p">,</span> <span class="s">&quot;MSOffice写文档&quot;</span><span class="p">,</span> <span class="s">&quot;记事本写程序&quot;</span><span class="p">,</span> <span class="s">&quot;Windows8&quot;</span><span class="p">,</span> <span class="s">&quot;Linux&quot;</span><span class="p">,</span> <span class="s">&quot;MacOS&quot;</span><span class="p">,</span> <span class="s">&quot;IE&quot;</span><span class="p">,</span> <span class="s">&quot;Android设备&quot;</span><span class="p">,</span> <span class="s">&quot;iOS设备&quot;</span><span class="p">)</span>
</span><span class='line'>
</span><span class='line'>    <span class="k">private</span> <span class="k">val</span> <span class="py">varNames</span> <span class="p">=</span> <span class="n">listOf</span><span class="p">(</span><span class="s">&quot;jieguo&quot;</span><span class="p">,</span> <span class="s">&quot;huodong&quot;</span><span class="p">,</span> <span class="s">&quot;pay&quot;</span><span class="p">,</span> <span class="s">&quot;expire&quot;</span><span class="p">,</span> <span class="s">&quot;zhangdan&quot;</span><span class="p">,</span> <span class="s">&quot;every&quot;</span><span class="p">,</span> <span class="s">&quot;free&quot;</span><span class="p">,</span> <span class="s">&quot;i1&quot;</span><span class="p">,</span> <span class="s">&quot;a&quot;</span><span class="p">,</span> <span class="s">&quot;virtual&quot;</span><span class="p">,</span> <span class="s">&quot;ad&quot;</span><span class="p">,</span> <span class="s">&quot;spider&quot;</span><span class="p">,</span> <span class="s">&quot;mima&quot;</span><span class="p">,</span> <span class="s">&quot;pass&quot;</span><span class="p">,</span> <span class="s">&quot;ui&quot;</span><span class="p">)</span>
</span><span class='line'>
</span><span class='line'>    <span class="k">private</span> <span class="k">val</span> <span class="py">drinks</span> <span class="p">=</span> <span class="n">listOf</span><span class="p">(</span><span class="s">&quot;水&quot;</span><span class="p">,</span> <span class="s">&quot;茶&quot;</span><span class="p">,</span> <span class="s">&quot;红茶&quot;</span><span class="p">,</span> <span class="s">&quot;绿茶&quot;</span><span class="p">,</span> <span class="s">&quot;咖啡&quot;</span><span class="p">,</span> <span class="s">&quot;奶茶&quot;</span><span class="p">,</span> <span class="s">&quot;可乐&quot;</span><span class="p">,</span> <span class="s">&quot;鲜奶&quot;</span><span class="p">,</span> <span class="s">&quot;豆奶&quot;</span><span class="p">,</span> <span class="s">&quot;果汁&quot;</span><span class="p">,</span> <span class="s">&quot;果味汽水&quot;</span><span class="p">,</span> <span class="s">&quot;苏打水&quot;</span><span class="p">,</span> <span class="s">&quot;运动饮料&quot;</span><span class="p">,</span> <span class="s">&quot;酸奶&quot;</span><span class="p">,</span> <span class="s">&quot;酒&quot;</span><span class="p">)</span>
</span><span class='line'>
</span><span class='line'>    <span class="k">private</span> <span class="k">val</span> <span class="py">today</span> <span class="p">=</span> <span class="n">GregorianCalendar</span><span class="p">()</span>
</span><span class='line'>    <span class="k">private</span> <span class="k">val</span> <span class="py">iday</span> <span class="p">=</span> <span class="n">today</span><span class="p">.</span><span class="k">get</span><span class="p">(</span><span class="n">Calendar</span><span class="p">.</span><span class="n">YEAR</span><span class="p">)</span> <span class="p">*</span> <span class="m">10000</span> <span class="p">+</span> <span class="p">(</span><span class="n">today</span><span class="p">.</span><span class="k">get</span><span class="p">(</span><span class="n">Calendar</span><span class="p">.</span><span class="n">MONTH</span><span class="p">)</span> <span class="p">+</span> <span class="m">1</span><span class="p">)</span> <span class="p">*</span> <span class="m">100</span> <span class="p">+</span> <span class="n">today</span><span class="p">.</span><span class="k">get</span><span class="p">(</span><span class="n">Calendar</span><span class="p">.</span><span class="n">DAY_OF_MONTH</span><span class="p">)</span>
</span><span class='line'>
</span><span class='line'>    <span class="k">private</span> <span class="k">fun</span> <span class="nf">random</span><span class="p">(</span><span class="n">seed</span><span class="p">:</span> <span class="n">Int</span><span class="p">,</span> <span class="n">index</span><span class="p">:</span> <span class="n">Int</span><span class="p">):</span> <span class="n">Int</span> <span class="p">{</span>
</span><span class='line'>        <span class="k">var</span> <span class="py">n</span> <span class="p">=</span> <span class="n">seed</span> <span class="p">%</span> <span class="m">11117</span>
</span><span class='line'>        <span class="k">for</span> <span class="p">(</span><span class="n">i</span> <span class="k">in</span> <span class="m">0</span> <span class="n">until</span> <span class="m">100</span><span class="p">+</span><span class="n">index</span><span class="p">)</span> <span class="p">{</span>
</span><span class='line'>            <span class="n">n</span> <span class="p">*=</span> <span class="n">n</span>
</span><span class='line'>            <span class="n">n</span> <span class="p">%=</span> <span class="m">11117</span>   <span class="c1">// 11117 是个质数</span>
</span><span class='line'>        <span class="p">}</span>
</span><span class='line'>        <span class="k">return</span> <span class="n">n</span>
</span><span class='line'>    <span class="p">}</span>
</span><span class='line'>
</span><span class='line'>    <span class="k">private</span> <span class="k">fun</span> <span class="nf">isSomeday</span><span class="p">():</span> <span class="n">Boolean</span> <span class="p">{</span>
</span><span class='line'>        <span class="k">return</span> <span class="n">today</span><span class="p">.</span><span class="k">get</span><span class="p">(</span><span class="n">Calendar</span><span class="p">.</span><span class="n">MONTH</span><span class="p">)</span> <span class="p">==</span> <span class="m">5</span> <span class="p">&amp;&amp;</span> <span class="n">today</span><span class="p">.</span><span class="k">get</span><span class="p">(</span><span class="n">Calendar</span><span class="p">.</span><span class="n">DAY_OF_MONTH</span><span class="p">)</span> <span class="p">==</span> <span class="m">4</span>
</span><span class='line'>    <span class="p">}</span>
</span><span class='line'>
</span><span class='line'>    <span class="k">private</span> <span class="k">fun</span> <span class="nf">star</span><span class="p">(</span><span class="n">num</span><span class="p">:</span> <span class="n">Int</span><span class="p">):</span> <span class="n">String</span> <span class="p">{</span>
</span><span class='line'>        <span class="k">var</span> <span class="py">result</span> <span class="p">=</span> <span class="s">&quot;&quot;</span>
</span><span class='line'>        <span class="k">var</span> <span class="py">i</span> <span class="p">=</span> <span class="m">0</span>
</span><span class='line'>        <span class="k">while</span> <span class="p">(</span><span class="n">i</span> <span class="p">&lt;</span> <span class="n">num</span><span class="p">)</span> <span class="p">{</span>
</span><span class='line'>            <span class="n">result</span> <span class="p">+=</span> <span class="s">&quot;★&quot;</span>
</span><span class='line'>            <span class="n">i</span><span class="p">++</span>
</span><span class='line'>        <span class="p">}</span>
</span><span class='line'>        <span class="k">while</span><span class="p">(</span><span class="n">i</span> <span class="p">&lt;</span> <span class="m">5</span><span class="p">)</span> <span class="p">{</span>
</span><span class='line'>            <span class="n">result</span> <span class="p">+=</span> <span class="s">&quot;☆&quot;</span>
</span><span class='line'>            <span class="n">i</span><span class="p">++</span>
</span><span class='line'>        <span class="p">}</span>
</span><span class='line'>        <span class="k">return</span> <span class="n">result</span>
</span><span class='line'>    <span class="p">}</span>
</span><span class='line'>
</span><span class='line'>    <span class="k">private</span> <span class="k">fun</span> <span class="nf">isWeekend</span><span class="p">():</span> <span class="n">Boolean</span> <span class="p">{</span>
</span><span class='line'>        <span class="k">return</span> <span class="n">today</span><span class="p">.</span><span class="k">get</span><span class="p">(</span><span class="n">Calendar</span><span class="p">.</span><span class="n">DAY_OF_WEEK</span><span class="p">)</span> <span class="p">==</span> <span class="m">0</span> <span class="p">||</span> <span class="n">today</span><span class="p">.</span><span class="k">get</span><span class="p">(</span><span class="n">Calendar</span><span class="p">.</span><span class="n">DAY_OF_WEEK</span><span class="p">)</span> <span class="p">==</span> <span class="m">6</span>
</span><span class='line'>    <span class="p">}</span>
</span><span class='line'>
</span><span class='line'>    <span class="c1">// 从 activities 中随机挑选 size 个</span>
</span><span class='line'>    <span class="k">private</span> <span class="k">fun</span> <span class="nf">pickRandomActivity</span><span class="p">(</span><span class="n">activities</span><span class="p">:</span> <span class="n">List</span><span class="p">&lt;</span><span class="n">Map</span><span class="p">&lt;</span><span class="n">String</span><span class="p">,</span> <span class="n">String</span><span class="p">&gt;&gt;,</span> <span class="n">size</span><span class="p">:</span> <span class="n">Int</span><span class="p">):</span> <span class="n">List</span><span class="p">&lt;</span><span class="n">Map</span><span class="p">&lt;</span><span class="n">String</span><span class="p">,</span> <span class="n">String</span><span class="p">&gt;&gt;</span> <span class="p">{</span>
</span><span class='line'>        <span class="k">val</span> <span class="py">pickedEvents</span> <span class="p">=</span> <span class="n">activities</span><span class="p">.</span><span class="n">pickRandom</span><span class="p">(</span><span class="n">size</span><span class="p">)</span>
</span><span class='line'>
</span><span class='line'>        <span class="k">return</span> <span class="n">pickedEvents</span><span class="p">.</span><span class="n">map</span> <span class="p">{</span> <span class="n">parse</span><span class="p">(</span><span class="n">it</span><span class="p">)</span> <span class="p">}</span>
</span><span class='line'>    <span class="p">}</span>
</span><span class='line'>
</span><span class='line'>    <span class="c1">// 从数组中随机挑选 size 个</span>
</span><span class='line'>    <span class="k">private</span> <span class="k">fun</span> <span class="err">&lt;</span><span class="nf">T</span><span class="p">&gt;</span> <span class="n">List</span><span class="p">&lt;</span><span class="n">T</span><span class="p">&gt;.</span><span class="n">pickRandom</span><span class="p">(</span><span class="n">size</span><span class="p">:</span> <span class="n">Int</span><span class="p">):</span> <span class="n">List</span><span class="p">&lt;</span><span class="n">T</span><span class="p">&gt;</span> <span class="p">{</span>
</span><span class='line'>        <span class="k">var</span> <span class="py">result</span> <span class="p">=</span> <span class="k">this</span><span class="p">.</span><span class="n">toMutableList</span><span class="p">()</span>
</span><span class='line'>        <span class="k">for</span> <span class="p">(</span><span class="n">j</span> <span class="k">in</span> <span class="m">0</span> <span class="n">until</span> <span class="k">this</span><span class="p">.</span><span class="n">size</span> <span class="p">-</span> <span class="n">size</span><span class="p">)</span> <span class="p">{</span>
</span><span class='line'>            <span class="k">val</span> <span class="py">index</span> <span class="p">=</span> <span class="n">random</span><span class="p">(</span><span class="n">iday</span><span class="p">,</span> <span class="n">j</span><span class="p">)</span> <span class="p">%</span> <span class="n">result</span><span class="p">.</span><span class="n">size</span>
</span><span class='line'>            <span class="n">result</span><span class="p">.</span><span class="n">removeAt</span><span class="p">(</span><span class="n">index</span><span class="p">)</span>
</span><span class='line'>        <span class="p">}</span>
</span><span class='line'>
</span><span class='line'>        <span class="k">return</span> <span class="n">result</span>
</span><span class='line'>    <span class="p">}</span>
</span><span class='line'>
</span><span class='line'>    <span class="c1">// 解析占位符并替换成随机内容</span>
</span><span class='line'>    <span class="k">private</span> <span class="k">fun</span> <span class="nf">parse</span><span class="p">(</span><span class="n">event</span><span class="p">:</span> <span class="n">Map</span><span class="p">&lt;</span><span class="n">String</span><span class="p">,</span> <span class="n">String</span><span class="p">&gt;):</span> <span class="n">Map</span><span class="p">&lt;</span><span class="n">String</span><span class="p">,</span> <span class="n">String</span><span class="p">&gt;</span> <span class="p">{</span>
</span><span class='line'>        <span class="k">var</span> <span class="py">result</span> <span class="p">=</span> <span class="n">event</span><span class="p">.</span><span class="n">toMutableMap</span><span class="p">()</span>
</span><span class='line'>
</span><span class='line'>        <span class="k">if</span> <span class="p">(</span><span class="n">result</span><span class="p">[</span><span class="n">NAME</span><span class="p">]</span><span class="o">?.</span><span class="n">indexOf</span><span class="p">(</span><span class="s">&quot;%v&quot;</span><span class="p">)</span> <span class="p">!=</span> <span class="p">-</span><span class="m">1</span><span class="p">)</span> <span class="p">{</span>
</span><span class='line'>            <span class="n">result</span><span class="p">[</span><span class="n">NAME</span><span class="p">]</span> <span class="p">=</span> <span class="n">result</span><span class="p">[</span><span class="n">NAME</span><span class="p">]</span><span class="o">?.</span><span class="n">replace</span><span class="p">(</span><span class="s">&quot;%v&quot;</span><span class="p">,</span> <span class="n">varNames</span><span class="p">[</span><span class="n">random</span><span class="p">(</span><span class="n">iday</span><span class="p">,</span> <span class="m">12</span><span class="p">)</span> <span class="p">%</span> <span class="n">varNames</span><span class="p">.</span><span class="n">size</span><span class="p">])</span><span class="o">!!</span>
</span><span class='line'>        <span class="p">}</span>
</span><span class='line'>
</span><span class='line'>        <span class="k">if</span> <span class="p">(</span><span class="n">result</span><span class="p">[</span><span class="n">NAME</span><span class="p">]</span><span class="o">?.</span><span class="n">indexOf</span><span class="p">(</span><span class="s">&quot;%t&quot;</span><span class="p">)</span> <span class="p">!=</span> <span class="p">-</span><span class="m">1</span><span class="p">)</span> <span class="p">{</span>
</span><span class='line'>            <span class="n">result</span><span class="p">[</span><span class="n">NAME</span><span class="p">]</span> <span class="p">=</span> <span class="n">result</span><span class="p">[</span><span class="n">NAME</span><span class="p">]</span><span class="o">?.</span><span class="n">replace</span><span class="p">(</span><span class="s">&quot;%t&quot;</span><span class="p">,</span> <span class="n">tools</span><span class="p">[</span><span class="n">random</span><span class="p">(</span><span class="n">iday</span><span class="p">,</span> <span class="m">11</span><span class="p">)</span> <span class="p">%</span> <span class="n">tools</span><span class="p">.</span><span class="n">size</span><span class="p">])</span><span class="o">!!</span>
</span><span class='line'>        <span class="p">}</span>
</span><span class='line'>
</span><span class='line'>        <span class="k">if</span> <span class="p">(</span><span class="n">result</span><span class="p">[</span><span class="n">NAME</span><span class="p">]</span><span class="o">?.</span><span class="n">indexOf</span><span class="p">(</span><span class="s">&quot;%l&quot;</span><span class="p">)</span> <span class="p">!=</span> <span class="p">-</span><span class="m">1</span><span class="p">)</span> <span class="p">{</span>
</span><span class='line'>            <span class="n">result</span><span class="p">[</span><span class="n">NAME</span><span class="p">]</span> <span class="p">=</span> <span class="n">result</span><span class="p">[</span><span class="n">NAME</span><span class="p">]</span><span class="o">?.</span><span class="n">replace</span><span class="p">(</span><span class="s">&quot;%l&quot;</span><span class="p">,</span> <span class="p">(</span><span class="n">random</span><span class="p">(</span><span class="n">iday</span><span class="p">,</span> <span class="m">12</span><span class="p">)</span> <span class="p">%</span> <span class="m">247</span> <span class="p">+</span> <span class="m">30</span><span class="p">).</span><span class="n">toString</span><span class="p">())</span><span class="o">!!</span>
</span><span class='line'>        <span class="p">}</span>
</span><span class='line'>
</span><span class='line'>        <span class="k">return</span> <span class="n">result</span><span class="p">.</span><span class="n">toMap</span><span class="p">()</span>
</span><span class='line'>    <span class="p">}</span>
</span><span class='line'>
</span><span class='line'>    <span class="c1">// 添加预定义事件</span>
</span><span class='line'>    <span class="c1">// Should return two lists: GOOD list and BAD list, the item of list is a map(dictionary)</span>
</span><span class='line'>    <span class="k">private</span> <span class="k">fun</span> <span class="nf">pickSpecials</span><span class="p">(</span><span class="n">goodList</span><span class="p">:</span> <span class="n">MutableList</span><span class="p">&lt;</span><span class="n">Map</span><span class="p">&lt;</span><span class="n">String</span><span class="p">,</span> <span class="n">String</span><span class="p">&gt;&gt;,</span> <span class="n">badList</span><span class="p">:</span> <span class="n">MutableList</span><span class="p">&lt;</span><span class="n">Map</span><span class="p">&lt;</span><span class="n">String</span><span class="p">,</span> <span class="n">String</span><span class="p">&gt;&gt;)</span> <span class="p">{</span>
</span><span class='line'>        <span class="n">specials</span><span class="p">.</span><span class="n">forEach</span> <span class="p">{</span>
</span><span class='line'>            <span class="k">if</span> <span class="p">(</span><span class="n">iday</span><span class="p">.</span><span class="n">toString</span><span class="p">()</span> <span class="p">==</span> <span class="n">it</span><span class="p">[</span><span class="n">DATE</span><span class="p">])</span> <span class="p">{</span>
</span><span class='line'>                <span class="k">if</span> <span class="p">(</span><span class="n">it</span><span class="p">[</span><span class="n">TYPE</span><span class="p">]</span> <span class="p">==</span> <span class="n">GOOD</span><span class="p">)</span> <span class="p">{</span>
</span><span class='line'>                    <span class="n">goodList</span><span class="p">.</span><span class="n">add</span><span class="p">(</span><span class="n">mapOf</span><span class="p">(</span><span class="n">NAME</span> <span class="n">to</span> <span class="n">it</span><span class="p">[</span><span class="n">NAME</span><span class="p">]</span><span class="o">!!</span><span class="p">,</span> <span class="n">GOOD</span> <span class="n">to</span> <span class="n">it</span><span class="p">[</span><span class="n">DESCRIPTION</span><span class="p">]</span><span class="o">!!</span><span class="p">))</span>
</span><span class='line'>                <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
</span><span class='line'>                    <span class="n">badList</span><span class="p">.</span><span class="n">add</span><span class="p">(</span><span class="n">mapOf</span><span class="p">(</span><span class="n">NAME</span> <span class="n">to</span> <span class="n">it</span><span class="p">[</span><span class="n">NAME</span><span class="p">]</span><span class="o">!!</span><span class="p">,</span> <span class="n">BAD</span> <span class="n">to</span> <span class="n">it</span><span class="p">[</span><span class="n">DESCRIPTION</span><span class="p">]</span><span class="o">!!</span><span class="p">))</span>
</span><span class='line'>                <span class="p">}</span>
</span><span class='line'>            <span class="p">}</span>
</span><span class='line'>        <span class="p">}</span>
</span><span class='line'>    <span class="p">}</span>
</span><span class='line'>
</span><span class='line'>    <span class="c1">// 生成今日运势</span>
</span><span class='line'>    <span class="c1">// Two part: from specials events and random picked from activities</span>
</span><span class='line'>    <span class="k">fun</span> <span class="nf">genTodayLuck</span><span class="p">():</span> <span class="n">Pair</span><span class="p">&lt;</span><span class="n">List</span><span class="p">&lt;</span><span class="n">Map</span><span class="p">&lt;</span><span class="n">String</span><span class="p">,</span> <span class="n">String</span><span class="p">&gt;&gt;,</span> <span class="n">List</span><span class="p">&lt;</span><span class="n">Map</span><span class="p">&lt;</span><span class="n">String</span><span class="p">,</span> <span class="n">String</span><span class="p">&gt;&gt;&gt;</span> <span class="p">{</span>
</span><span class='line'>        <span class="k">var</span> <span class="py">theActivities</span> <span class="p">=</span> <span class="k">if</span> <span class="p">(</span><span class="n">isWeekend</span><span class="p">())</span> <span class="n">activities</span><span class="p">.</span><span class="n">filter</span> <span class="p">{</span> <span class="n">it</span><span class="p">[</span><span class="n">WEEKEND</span><span class="p">]</span> <span class="p">==</span> <span class="s">&quot;true&quot;</span> <span class="p">}</span> <span class="k">else</span> <span class="n">activities</span>
</span><span class='line'>
</span><span class='line'>        <span class="k">val</span> <span class="py">goodList</span> <span class="p">=</span> <span class="n">ArrayList</span><span class="p">&lt;</span><span class="n">Map</span><span class="p">&lt;</span><span class="n">String</span><span class="p">,</span> <span class="n">String</span><span class="p">&gt;&gt;()</span>
</span><span class='line'>        <span class="k">val</span> <span class="py">badList</span> <span class="p">=</span> <span class="n">ArrayList</span><span class="p">&lt;</span><span class="n">Map</span><span class="p">&lt;</span><span class="n">String</span><span class="p">,</span> <span class="n">String</span><span class="p">&gt;&gt;()</span>
</span><span class='line'>        <span class="n">pickSpecials</span><span class="p">(</span><span class="n">goodList</span><span class="p">,</span> <span class="n">badList</span><span class="p">)</span>
</span><span class='line'>
</span><span class='line'>        <span class="k">val</span> <span class="py">numGood</span> <span class="p">=</span> <span class="n">random</span><span class="p">(</span><span class="n">iday</span><span class="p">,</span> <span class="m">98</span><span class="p">)</span> <span class="p">%</span> <span class="m">3</span> <span class="p">+</span> <span class="m">2</span>
</span><span class='line'>        <span class="k">val</span> <span class="py">numBad</span> <span class="p">=</span> <span class="n">random</span><span class="p">(</span><span class="n">iday</span><span class="p">,</span> <span class="m">87</span><span class="p">)</span> <span class="p">%</span> <span class="m">3</span> <span class="p">+</span> <span class="m">2</span>
</span><span class='line'>        <span class="k">val</span> <span class="py">pickedEvents</span> <span class="p">=</span> <span class="n">pickRandomActivity</span><span class="p">(</span><span class="n">theActivities</span><span class="p">,</span> <span class="n">numGood</span> <span class="p">+</span> <span class="n">numBad</span><span class="p">)</span>
</span><span class='line'>
</span><span class='line'>        <span class="c1">// Add random picked from activities to GOOD/BAD list</span>
</span><span class='line'>        <span class="k">for</span> <span class="p">(</span><span class="n">i</span> <span class="k">in</span> <span class="m">0</span> <span class="n">until</span> <span class="n">numGood</span><span class="p">)</span> <span class="p">{</span>
</span><span class='line'>            <span class="n">goodList</span><span class="p">.</span><span class="n">add</span><span class="p">(</span><span class="n">mapOf</span><span class="p">(</span><span class="n">NAME</span> <span class="n">to</span> <span class="n">pickedEvents</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">NAME</span><span class="p">]</span><span class="o">!!</span><span class="p">,</span> <span class="n">DESCRIPTION</span> <span class="n">to</span> <span class="n">pickedEvents</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">GOOD</span><span class="p">]</span><span class="o">!!</span><span class="p">))</span>
</span><span class='line'>        <span class="p">}</span>
</span><span class='line'>        <span class="k">for</span> <span class="p">(</span><span class="n">i</span> <span class="k">in</span> <span class="m">0</span> <span class="n">until</span> <span class="n">numBad</span><span class="p">)</span> <span class="p">{</span>
</span><span class='line'>            <span class="n">badList</span><span class="p">.</span><span class="n">add</span><span class="p">(</span><span class="n">mapOf</span><span class="p">(</span><span class="n">NAME</span> <span class="n">to</span> <span class="n">pickedEvents</span><span class="p">[</span><span class="n">numGood</span> <span class="p">+</span> <span class="n">i</span><span class="p">][</span><span class="n">NAME</span><span class="p">]</span><span class="o">!!</span><span class="p">,</span> <span class="n">DESCRIPTION</span> <span class="n">to</span> <span class="n">pickedEvents</span><span class="p">[</span><span class="n">numGood</span> <span class="p">+</span> <span class="n">i</span><span class="p">][</span><span class="n">BAD</span><span class="p">]</span><span class="o">!!</span><span class="p">))</span>
</span><span class='line'>        <span class="p">}</span>
</span><span class='line'>        <span class="k">return</span> <span class="n">Pair</span><span class="p">(</span><span class="n">goodList</span><span class="p">,</span> <span class="n">badList</span><span class="p">)</span>
</span><span class='line'>    <span class="p">}</span>
</span><span class='line'>
</span><span class='line'>    <span class="k">fun</span> <span class="nf">genTodayString</span><span class="p">():</span> <span class="n">String</span> <span class="p">{</span>
</span><span class='line'>        <span class="k">return</span> <span class="s">&quot;今天是&quot;</span> <span class="p">+</span> <span class="n">today</span><span class="p">.</span><span class="k">get</span><span class="p">(</span><span class="n">Calendar</span><span class="p">.</span><span class="n">YEAR</span><span class="p">)</span> <span class="p">+</span>
</span><span class='line'>                <span class="s">&quot;年&quot;</span> <span class="p">+</span> <span class="p">(</span><span class="n">today</span><span class="p">.</span><span class="k">get</span><span class="p">(</span><span class="n">Calendar</span><span class="p">.</span><span class="n">MONTH</span><span class="p">)</span> <span class="p">+</span> <span class="m">1</span><span class="p">)</span> <span class="p">+</span>
</span><span class='line'>                <span class="s">&quot;月&quot;</span> <span class="p">+</span> <span class="n">today</span><span class="p">.</span><span class="k">get</span><span class="p">(</span><span class="n">Calendar</span><span class="p">.</span><span class="n">DAY_OF_MONTH</span><span class="p">)</span> <span class="p">+</span>
</span><span class='line'>                <span class="s">&quot;日 星期&quot;</span> <span class="p">+</span> <span class="n">weeks</span><span class="p">[</span><span class="n">today</span><span class="p">.</span><span class="k">get</span><span class="p">(</span><span class="n">Calendar</span><span class="p">.</span><span class="n">DAY_OF_WEEK</span><span class="p">)</span> <span class="p">-</span> <span class="m">1</span><span class="p">]</span>
</span><span class='line'>    <span class="p">}</span>
</span><span class='line'>
</span><span class='line'>    <span class="k">fun</span> <span class="nf">genDirection</span><span class="p">():</span> <span class="n">String</span> <span class="p">{</span>
</span><span class='line'>        <span class="k">val</span> <span class="py">index</span> <span class="p">=</span> <span class="n">random</span><span class="p">(</span><span class="n">iday</span><span class="p">,</span> <span class="m">2</span><span class="p">)</span> <span class="p">%</span> <span class="n">directions</span><span class="p">.</span><span class="n">size</span>
</span><span class='line'>        <span class="k">return</span> <span class="n">directions</span><span class="p">[</span><span class="n">index</span><span class="p">]</span>
</span><span class='line'>    <span class="p">}</span>
</span><span class='line'>
</span><span class='line'>    <span class="k">fun</span> <span class="nf">genGirlsIndex</span><span class="p">():</span> <span class="n">String</span> <span class="p">{</span>
</span><span class='line'>        <span class="k">return</span> <span class="n">star</span><span class="p">(</span><span class="n">random</span><span class="p">(</span><span class="n">iday</span><span class="p">,</span> <span class="m">6</span><span class="p">)</span> <span class="p">%</span> <span class="m">5</span> <span class="p">+</span> <span class="m">1</span><span class="p">)</span>
</span><span class='line'>    <span class="p">}</span>
</span><span class='line'>
</span><span class='line'>    <span class="k">fun</span> <span class="nf">genDrinks</span><span class="p">():</span> <span class="n">String</span> <span class="p">{</span>
</span><span class='line'>        <span class="k">return</span> <span class="n">drinks</span><span class="p">.</span><span class="n">pickRandom</span><span class="p">(</span><span class="m">2</span><span class="p">).</span><span class="n">joinToString</span><span class="p">(</span><span class="s">&quot;, &quot;</span><span class="p">)</span>
</span><span class='line'>    <span class="p">}</span>
</span><span class='line'><span class="p">}</span>
</span></code></pre></td></tr></table></div></figure>


<p>完整的代码可以到这里<a href="https://github.com/alexhilton/KotlinHello">下载</a>。</p>

<h3>用到的新特性</h3>

<p>从代码中看到，除了上一篇文章外，还用到了一些Kotlin语言的特性：</p>

<h4>Ranges</h4>

<p>可以理解为区间，用于按某些范围来迭代，看一下例子中genTodayLuck方法就能明白。下面也简单的补充下：</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
</pre></td><td class='code'><pre><code class='kotlin'><span class='line'><span class="k">for</span> <span class="p">(</span><span class="n">i</span> <span class="k">in</span> <span class="m">1.</span><span class="p">.</span><span class="m">10</span><span class="p">)</span> <span class="c1">// 等同于for (int i = 1; i &lt;= 10; i++)</span>
</span><span class='line'><span class="k">for</span> <span class="p">(</span><span class="n">i</span> <span class="k">in</span> <span class="m">0</span> <span class="n">until</span> <span class="m">10</span><span class="p">)</span> <span class="c1">// 等同于for (int i = 0; i &lt; 10; i++)</span>
</span></code></pre></td></tr></table></div></figure>


<p>自己可以体会上面的两个不同，还有就是还可以用于if判断：</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class='kotlin'><span class='line'><span class="k">if</span> <span class="p">(</span><span class="n">a</span> <span class="k">in</span> <span class="m">1.</span><span class="p">.</span><span class="m">10</span><span class="p">)</span> <span class="c1">// if (1 &lt;= a &amp;&amp; a &lt;= 10)</span>
</span></code></pre></td></tr></table></div></figure>


<p>默认步长是1, 当然也可以自定义：</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class='kotlin'><span class='line'><span class="k">for</span> <span class="p">(</span><span class="n">i</span> <span class="k">in</span> <span class="m">1.</span><span class="p">.</span><span class="m">10</span> <span class="n">step</span> <span class="m">2</span><span class="p">)</span> <span class="c1">// =&gt; for (int i = 1; i &lt;= 10; i += 2)</span>
</span></code></pre></td></tr></table></div></figure>


<h4>Extension function</h4>

<p>可以给已存在的类添加方法，非继承也非组合的方式，与Object-C中的Category很像。这会让在基于某个类，执行某种操作时，非常的简洁，比如此例中的pickRandom方法，如果常规实现是把列表作为一个参数传入，但是用了Extension function后，使用的时候就仿佛这是Collection本身提供的一个方法一样，可读性与简洁性大大提升。</p>

<h4>Companion object</h4>

<p>与内部类概念类似，就是想在一个类的内部再声明一个类，就要用companion object，引用companion object的成员时可以省略它的类的名字，如示例中，在CalendarActivity中引用ProgrammerCalendar的companion object EventKeys时可以省略:</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class='kotlin'><span class='line'><span class="n">ProgrammerCalendar</span><span class="p">.</span><span class="n">DESCRIPTION</span>
</span></code></pre></td></tr></table></div></figure>


<h4>const关键字</h4>

<p>上一篇文章，介绍过变量用var声明，常量用val来声明，那关键字const又是什么鬼呢？原来它用于声明类的顶级属性（用人话说，就是非内部类），其作用相当于Java中的static final：</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class='kotlin'><span class='line'><span class="n">const</span> <span class="k">val</span> <span class="py">NAME</span> <span class="p">=</span> <span class="s">&quot;name&quot;</span> <span class="c1">//相当于Java中的public static final String NAME = &quot;name&quot;;</span>
</span></code></pre></td></tr></table></div></figure>


<h2>参考资料</h2>

<ul>
<li><a href="https://www.sitepoint.com/building-a-ui-with-kotlin-and-anko/">Building a UI with Kotlin and Anko</a></li>
</ul>

</div>


  <footer>
    <p class="meta">
      
  

<span class="byline author vcard">Posted by <span class="fn">Alex Hilton</span></span>

      




<time class='entry-date' datetime='2018-06-09T16:10:24+08:00'><span class='date'><span class='date-month'>Jun</span> <span class='date-day'>9</span><span class='date-suffix'>th</span>, <span class='date-year'>2018</span></span> <span class='time'>4:10 pm</span></time>
      

<span class="categories">
  
    <a class='category' href='/blog/categories/kotlin/'>kotlin</a>
  
</span>


    </p>
    
      <div class="sharing">
  
  
  
  
    <!-- JiaThis Button BEGIN -->
<div class="jiathis_style_32x32">
	<a class="jiathis_button_qzone"></a>
	<a class="jiathis_button_tsina"></a>
	<a class="jiathis_button_tqq"></a>
	<a class="jiathis_button_weixin"></a>
	<a class="jiathis_button_renren"></a>
	<a href="http://www.jiathis.com/share" class="jiathis jiathis_txt jtico jtico_jiathis" target="_blank"></a>
	<a class="jiathis_counter_style"></a>
</div>
<script type="text/javascript" src="http://v3.jiathis.com/code/jia.js" charset="utf-8"></script>
<!-- JiaThis Button END -->

  
</div>

    
    <p class="meta">
      
        <a class="basic-alignment left" href="/blog/2018/05/17/introduction-to-kotlin-programming-language/" title="Previous Post: 学习Kotlin，看这一篇就够了">&laquo; 学习Kotlin，看这一篇就够了</a>
      
      
        <a class="basic-alignment right" href="/blog/2018/06/11/golden-state-worriors-rule/" title="Next Post: 金州王朝已经建立，老詹可以就此退役">金州王朝已经建立，老詹可以就此退役 &raquo;</a>
      
    </p>
  </footer>
</article>

  <section>
    <h1>Comments</h1>
    <div id="comments"></div>
    <!-- Duoshuo COMMENT BEGIN -->
<script src="https://imsun.github.io/gitment/dist/gitment.browser.js"></script>
<script>
    var clientId = 'bc66a01ef24d14fc282b'
    var clientSecret = 'c7fd5e55db1776204fe201fe20c050b140982884'
    var gitment = new Gitment({
      id: 'toughcoder.net',
      owner: 'alexhilton',
      repo: 'alexhilton.github.io',
      oauth: {
        client_id: clientId,
        client_secret: clientSecret,
      },
    })

    gitment.render('comments')
</script>
<!-- Duoshuo COMMENT END -->

  </section>

</div>

<aside class="sidebar">
  
    <section>
    <div class="
        col-lg-2 col-lg-offset-0
        visible-lg-block
        sidebar-container
        catalog-container">
        <div class="side-catalog">
            <hr class="hidden-sm hidden-xs">
            <h3>
                <a class="catalog-toggle" href="#">CATALOG</a>
            </h3>
            <ul class="catalog-body"></ul>
        </div>
    </div>
</section>
<!-- Back to top and Scroll to bottom -->
<a href="#" class="cd-top"></a>
<a href="#" class="cd-bottom"></a>

  
</aside>


    </div>
  </div>
  <footer role="contentinfo"><p>
  Copyright &copy; 2022 - Alex Hilton -
  <span class="credit">Powered by <a href="http://octopress.org">Octopress</a></span>
</p>

</footer>
  









<script type="text/javascript">
    //async load function 
    function async(u, c) {
        var d = document, t = 'script',
            o = d.createElement(t),
            s = d.getElementsByTagName(t)[0];
        o.src = u;
        if (c) { o.addEventListener('load', function (e) { c(null, e); }, false); }
        s.parentNode.insertBefore(o, s);
    }

    function generateCatalog (selector) {
        var P = $('article'),a,n,t,l,i,c, id;
        a = P.find('h2,h3,h4,h5,h6');
        var index = 0;
        a.each(function () {
            n = $(this).prop('tagName').toLowerCase();
            id = $(this).prop('id');
            if (!id) {
                var nid = 'catalog-section-' + index;
                $(this).attr('id', nid);
                i = '#' + nid;
            } else {
                i = '#' + id;
            }
            t = $(this).text();
            c = $('<a href="'+i+'" rel="nofollow">'+t+'</a>');
            l = $('<li class="'+n+'_nav"></li>').append(c);
            $(selector).append(l);
            index++;
        });
        return true;
    }

    generateCatalog(".catalog-body");

    // toggle side catalog
    $(".catalog-toggle").click((function(e){
        e.preventDefault();
        $('.side-catalog').toggleClass("fold")
    }))

    /*
     * Doc: https://github.com/davist11/jQuery-One-Page-Nav
     * Fork by Hux to support padding
     */
    async("/javascripts/jquery.nav.js", function () {
        $('.catalog-body').onePageNav({
            currentClass: "active",
            changeHash: !1,
            easing: "swing",
            filter: "",
            scrollSpeed: 700,
            scrollOffset: 0,
            scrollThreshold: .2,
            begin: null,
            end: null,
            scrollChange: null,
            padding: 80
        });
    });

// Navigation Scripts to Show Header on Scroll-Up
jQuery(document).ready(function($) {
    var MQL = 1170;

    //primary navigation slide-in effect
    if ($(window).width() > MQL) {
        // We do not have the sticky nav bar so, first can be zero
        var headerHeight = 0;
        $('nav').each(function() {
            var h = $(this).outerHeight(true);
            headerHeight += h;
        });
        $('header').each(function() {
            var h = $(this).outerHeight(true);
            headerHeight += h;
        });
        $(window).on('scroll', {
                previousTop: 0
            },
            function() {
                var currentTop = $(window).scrollTop(),
                    $catalog = $('.side-catalog');

                this.previousTop = currentTop;

                //adjust the appearance of side-catalog
                $catalog.show()
                if (currentTop > (headerHeight + 42)) {
                    $catalog.addClass('fixed')
                } else {
                    $catalog.removeClass('fixed')
                }
            });
    }
});
</script>

<script>
    var _hmt = _hmt || [];
    (function() {
         var hm = document.createElement("script");
         hm.src = "//hm.baidu.com/hm.js?3b8ca71d801a2f5af0a456e0b4635bae";
         var s = document.getElementsByTagName("script")[0];
         s.parentNode.insertBefore(hm, s);
    })();
</script>


</body>
</html>
